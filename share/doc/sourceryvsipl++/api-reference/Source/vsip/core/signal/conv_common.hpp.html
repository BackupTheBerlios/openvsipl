<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
<!-- Source/vsip/core/signal/conv_common.hpp.html -->
<!-- this view was generated by Source -->
<head>
<meta content="text/html; charset=iso-8859-1" http-equiv="Content-Type"/>
<title>Synopsis - vsip/core/signal/conv_common.hpp</title>
<link href="../../../../synopsis.css" type="text/css" rel="stylesheet"/>
<script src="../../../../synopsis.js" type="text/javascript"></script>
</head>
<body class="Source" onload="load()">
<div class="navigation">
<span class="normal"><a href="../../../../Scopes/global.html">Global Namespace</a></span>
<span class="normal"><a href="../../../../InheritanceTree.html">Inheritance Tree</a></span>
<span class="normal"><a href="../../../../InheritanceGraph.html">Inheritance Graph</a></span>
<span class="normal"><a href="../../../../NameIndex.html">Name Index</a></span>
</div>
File: <b>vsip/core/signal/conv_common.hpp</b><pre class="sxr"><a id="line1"></a><span class="lineno">   1</span><span class="line"><span class="comment">/* Copyright (c) 2005 by CodeSourcery, LLC.  All rights reserved. */</span></span>
<a id="line2"></a><span class="lineno">   2</span>
<a id="line3"></a><span class="lineno">   3</span><span class="line"><span class="comment">/** @file    vsip/core/signal/conv_common.hpp</span></span>
<a id="line4"></a><span class="lineno">   4</span><span class="line"><span class="comment">    @author  Jules Bergmann</span></span>
<a id="line5"></a><span class="lineno">   5</span><span class="line"><span class="comment">    @date    08/31/2005</span></span>
<a id="line6"></a><span class="lineno">   6</span><span class="line"><span class="comment">    @brief   VSIPL++ Library: Common decls and functions for convolution.</span></span>
<a id="line7"></a><span class="lineno">   7</span><span class="line"><span class="comment">*/</span></span>
<a id="line8"></a><span class="lineno">   8</span>
<a id="line9"></a><span class="lineno">   9</span><span class="line">#ifndef VSIP_CORE_SIGNAL_CONV_COMMON_HPP</span>
<a id="line10"></a><span class="lineno">  10</span><span class="line">#define VSIP_CORE_SIGNAL_CONV_COMMON_HPP</span>
<a id="line11"></a><span class="lineno">  11</span>
<a id="line12"></a><span class="lineno">  12</span><span class="line"><span class="comment">/***********************************************************************</span></span>
<a id="line13"></a><span class="lineno">  13</span><span class="line"><span class="comment">  Included Files</span></span>
<a id="line14"></a><span class="lineno">  14</span><span class="line"><span class="comment">***********************************************************************/</span></span>
<a id="line15"></a><span class="lineno">  15</span>
<a id="line16"></a><span class="lineno">  16</span><span class="line">#include &lt;vsip/support.hpp&gt;</span>
<a id="line17"></a><span class="lineno">  17</span><span class="line">#include &lt;vsip/domain.hpp&gt;</span>
<a id="line18"></a><span class="lineno">  18</span><span class="line">#include &lt;vsip/vector.hpp&gt;</span>
<a id="line19"></a><span class="lineno">  19</span><span class="line">#include &lt;vsip/matrix.hpp&gt;</span>
<a id="line20"></a><span class="lineno">  20</span><span class="line">#include &lt;vsip/core/domain_utils.hpp&gt;</span>
<a id="line21"></a><span class="lineno">  21</span><span class="line">#include &lt;vsip/core/signal/types.hpp&gt;</span>
<a id="line22"></a><span class="lineno">  22</span>
<a id="line23"></a><span class="lineno">  23</span>
<a id="line24"></a><span class="lineno">  24</span>
<a id="line25"></a><span class="lineno">  25</span><span class="line"><span class="comment">// C-VSIPL defines the size of the support_min convolution such that</span></span>
<a id="line26"></a><span class="lineno">  26</span><span class="line"><span class="comment">// it sometimes requires values outside of the input support for</span></span>
<a id="line27"></a><span class="lineno">  27</span><span class="line"><span class="comment">// decimations not equal to 1.</span></span>
<a id="line28"></a><span class="lineno">  28</span><span class="line"><span class="comment">//</span></span>
<a id="line29"></a><span class="lineno">  29</span><span class="line"><span class="comment">// This define controls VSIPL++'s behavior for support_min convolutions:</span></span>
<a id="line30"></a><span class="lineno">  30</span><span class="line"><span class="comment">//</span></span>
<a id="line31"></a><span class="lineno">  31</span><span class="line"><span class="comment">// If unset or set to 0, the output size of a support_min</span></span>
<a id="line32"></a><span class="lineno">  32</span><span class="line"><span class="comment">// convolution is as defined by VSIPL++ / C-VSIPL specifications.</span></span>
<a id="line33"></a><span class="lineno">  33</span><span class="line"><span class="comment">//</span></span>
<a id="line34"></a><span class="lineno">  34</span><span class="line"><span class="comment">//       size = floor( (N-1) / D ) - floor( (M-1) / D ) + 1</span></span>
<a id="line35"></a><span class="lineno">  35</span><span class="line"><span class="comment">//</span></span>
<a id="line36"></a><span class="lineno">  36</span><span class="line"><span class="comment">// If set to a value other than 0, the output size of a support_min</span></span>
<a id="line37"></a><span class="lineno">  37</span><span class="line"><span class="comment">// convolution is defined to be:</span></span>
<a id="line38"></a><span class="lineno">  38</span><span class="line"><span class="comment">//</span></span>
<a id="line39"></a><span class="lineno">  39</span><span class="line"><span class="comment">//       size = ceil( (N-M+1) / D )</span></span>
<a id="line40"></a><span class="lineno">  40</span><span class="line"> </span>
<a id="line41"></a><span class="lineno">  41</span><span class="line">#define VSIP_IMPL_CONV_CORRECT_MIN_SUPPORT_SIZE 1</span>
<a id="line42"></a><span class="lineno">  42</span>
<a id="line43"></a><span class="lineno">  43</span>
<a id="line44"></a><span class="lineno">  44</span>
<a id="line45"></a><span class="lineno">  45</span><span class="line"><span class="comment">/***********************************************************************</span></span>
<a id="line46"></a><span class="lineno">  46</span><span class="line"><span class="comment">  Declarations</span></span>
<a id="line47"></a><span class="lineno">  47</span><span class="line"><span class="comment">***********************************************************************/</span></span>
<a id="line48"></a><span class="lineno">  48</span>
<a id="line49"></a><span class="lineno">  49</span><span class="line"><span class="keyword">namespace</span> <a href="../../../../Scopes/vsip_csl.html" title="namespace vsip_csl">vsip_csl</a></span>
<a id="line50"></a><span class="lineno">  50</span><span class="line">{</span>
<a id="line51"></a><span class="lineno">  51</span><span class="line"><span class="keyword">namespace</span> <a href="../../../../Scopes/vsip_csl/dispatcher.html" title="namespace vsip_csl::dispatcher">dispatcher</a></span>
<a id="line52"></a><span class="lineno">  52</span><span class="line">{</span>
<a id="line53"></a><span class="lineno">  53</span><span class="line"><span class="keyword">namespace</span> <a href="" title="namespace vsip_csl::dispatcher::op">op</a></span>
<a id="line54"></a><span class="lineno">  54</span><span class="line">{</span>
<a id="line55"></a><span class="lineno">  55</span><span class="line">template &lt;dimension_type D,</span>
<a id="line56"></a><span class="lineno">  56</span><span class="line">          symmetry_type S,</span>
<a id="line57"></a><span class="lineno">  57</span><span class="line">          support_region_type R,</span>
<a id="line58"></a><span class="lineno">  58</span><span class="line">          typename T = VSIP_DEFAULT_VALUE_TYPE,</span>
<a id="line59"></a><span class="lineno">  59</span><span class="line">          unsigned int N = 0,</span>
<a id="line60"></a><span class="lineno">  60</span><span class="line">          alg_hint_type H = alg_time&gt;</span>
<a id="line61"></a><span class="lineno">  61</span><span class="line">struct conv;</span>
<a id="line62"></a><span class="lineno">  62</span><span class="line">} <span class="comment">// namespace vsip_csl::dispatcher::op</span></span>
<a id="line63"></a><span class="lineno">  63</span><span class="line">} <span class="comment">// namespace vsip_csl::dispatcher</span></span>
<a id="line64"></a><span class="lineno">  64</span><span class="line">} <span class="comment">// namespace vsip_csl</span></span>
<a id="line65"></a><span class="lineno">  65</span>
<a id="line66"></a><span class="lineno">  66</span><span class="line"><span class="keyword">namespace</span> <a href="../../../../Scopes/vsip.html" title="namespace vsip">vsip</a></span>
<a id="line67"></a><span class="lineno">  67</span><span class="line">{</span>
<a id="line68"></a><span class="lineno">  68</span><span class="line"><span class="keyword">namespace</span> <a href="../../../../Scopes/vsip/impl.html" title="namespace vsip::impl">impl</a></span>
<a id="line69"></a><span class="lineno">  69</span><span class="line">{</span>
<a id="line70"></a><span class="lineno">  70</span>
<a id="line71"></a><span class="lineno">  71</span><span class="line">template &lt;typename T&gt;</span>
<a id="line72"></a><span class="lineno">  72</span><span class="line"><span class="keyword">struct</span> <a href="../../../../Scopes/vsip/impl/Convolution_accum_trait.html" title="struct vsip::impl::Convolution_accum_trait">Convolution_accum_trait</a></span>
<a id="line73"></a><span class="lineno">  73</span><span class="line">{</span>
<a id="line74"></a><span class="lineno">  74</span><span class="line">  <span class="keyword">typedef</span> T <a href="../../../../Scopes/vsip/impl/Convolution_accum_trait.html#sum_type" title="typedef vsip::impl::Convolution_accum_trait::sum_type">sum_type</a>;</span>
<a id="line75"></a><span class="lineno">  75</span><span class="line">};</span>
<a id="line76"></a><span class="lineno">  76</span>
<a id="line77"></a><span class="lineno">  77</span>
<a id="line78"></a><span class="lineno">  78</span>
<a id="line79"></a><span class="lineno">  79</span><span class="line"><span class="comment">/***********************************************************************</span></span>
<a id="line80"></a><span class="lineno">  80</span><span class="line"><span class="comment">  Definitions</span></span>
<a id="line81"></a><span class="lineno">  81</span><span class="line"><span class="comment">***********************************************************************/</span></span>
<a id="line82"></a><span class="lineno">  82</span>
<a id="line83"></a><span class="lineno">  83</span><span class="line"><span class="comment">/// Helper function to determine the kernel_size of a convolution, based</span></span>
<a id="line84"></a><span class="lineno">  84</span><span class="line"><span class="comment">/// on the size of the coefficient view and its symmetry.</span></span>
<a id="line85"></a><span class="lineno">  85</span><span class="line">template &lt;symmetry_type S, dimension_type D&gt; </span>
<a id="line86"></a><span class="lineno">  86</span><span class="line"><a href="../../../../Scopes/vsip/Domain.html" title="class vsip::Domain">Domain</a>&lt;D&gt;</span>
<a id="line87"></a><span class="lineno">  87</span><span class="line"><a href="../../../../Scopes/vsip/impl.html#conv_kernel_size_lconst.Domain_LD_R_A_r" title="function template vsip::impl::conv_kernel_size(const Domain&lt;D&gt;&amp;)">conv_kernel_size</a>(<a href="../../../../Scopes/vsip/Domain.html" title="class vsip::Domain">Domain</a>&lt;D&gt; const &amp;coeff_size);</span>
<a id="line88"></a><span class="lineno">  88</span>
<a id="line89"></a><span class="lineno">  89</span><span class="line">template &lt;&gt;</span>
<a id="line90"></a><span class="lineno">  90</span><span class="line">inline <a href="../../../../Scopes/vsip/Domain.html" title="class vsip::Domain">Domain</a>&lt;1&gt;</span>
<a id="line91"></a><span class="lineno">  91</span><span class="line"><a href="../../../../Scopes/vsip/impl.html#conv_kernel_size_Ltype_ctype_R_lconst.Domain_L_S_R_A_r" title="function vsip::impl::conv_kernel_size&lt;type,type&gt;(const Domain&lt;*&gt;&amp;)">conv_kernel_size&lt;sym_even_len_odd, 1&gt;</a>(<a href="../../../../Scopes/vsip/Domain.html" title="class vsip::Domain">Domain</a>&lt;1&gt; const &amp;coeff_size) </span>
<a id="line92"></a><span class="lineno">  92</span><span class="line">{ <span class="keyword">return</span> <span class="literal">2</span> * <a href="" title="parameter coeff_size">coeff_size</a>.length() - <span class="literal">1</span>;}</span>
<a id="line93"></a><span class="lineno">  93</span>
<a id="line94"></a><span class="lineno">  94</span><span class="line">template &lt;&gt;</span>
<a id="line95"></a><span class="lineno">  95</span><span class="line">inline <a href="../../../../Scopes/vsip/Domain.html" title="class vsip::Domain">Domain</a>&lt;1&gt;</span>
<a id="line96"></a><span class="lineno">  96</span><span class="line"><a href="../../../../Scopes/vsip/impl.html#conv_kernel_size_Ltype_ctype_R_lconst.Domain_L_S_R_A_r" title="function vsip::impl::conv_kernel_size&lt;type,type&gt;(const Domain&lt;*&gt;&amp;)">conv_kernel_size&lt;sym_even_len_even, 1&gt;</a>(<a href="../../../../Scopes/vsip/Domain.html" title="class vsip::Domain">Domain</a>&lt;1&gt; const &amp;coeff_size) </span>
<a id="line97"></a><span class="lineno">  97</span><span class="line">{ <span class="keyword">return</span> <span class="literal">2</span> * <a href="" title="parameter coeff_size">coeff_size</a>.length();}</span>
<a id="line98"></a><span class="lineno">  98</span>
<a id="line99"></a><span class="lineno">  99</span><span class="line">template &lt;&gt;</span>
<a id="line100"></a><span class="lineno"> 100</span><span class="line">inline <a href="../../../../Scopes/vsip/Domain.html" title="class vsip::Domain">Domain</a>&lt;1&gt;</span>
<a id="line101"></a><span class="lineno"> 101</span><span class="line"><a href="../../../../Scopes/vsip/impl.html#conv_kernel_size_Ltype_ctype_R_lconst.Domain_L_S_R_A_r" title="function vsip::impl::conv_kernel_size&lt;type,type&gt;(const Domain&lt;*&gt;&amp;)">conv_kernel_size&lt;nonsym, 1&gt;</a>(<a href="../../../../Scopes/vsip/Domain.html" title="class vsip::Domain">Domain</a>&lt;1&gt; const &amp;coeff_size) </span>
<a id="line102"></a><span class="lineno"> 102</span><span class="line">{ <span class="keyword">return</span> <a href="" title="parameter coeff_size">coeff_size</a>.length();}</span>
<a id="line103"></a><span class="lineno"> 103</span>
<a id="line104"></a><span class="lineno"> 104</span><span class="line">template &lt;&gt;</span>
<a id="line105"></a><span class="lineno"> 105</span><span class="line">inline <a href="../../../../Scopes/vsip/Domain.html" title="class vsip::Domain">Domain</a>&lt;2&gt;</span>
<a id="line106"></a><span class="lineno"> 106</span><span class="line"><a href="../../../../Scopes/vsip/impl.html#conv_kernel_size_Ltype_ctype_R_lconst.Domain_L_S_R_A_r" title="function vsip::impl::conv_kernel_size&lt;type,type&gt;(const Domain&lt;*&gt;&amp;)">conv_kernel_size&lt;sym_even_len_odd, 2&gt;</a>(<a href="../../../../Scopes/vsip/Domain.html" title="class vsip::Domain">Domain</a>&lt;2&gt; const &amp;coeff_size) </span>
<a id="line107"></a><span class="lineno"> 107</span><span class="line">{ <span class="keyword">return</span> Domain&lt;2&gt;(<span class="literal">2</span> * <a href="" title="parameter coeff_size">coeff_size</a>[<span class="literal">0</span>].length() - <span class="literal">1</span>, <span class="literal">2</span> * <a href="" title="parameter coeff_size">coeff_size</a>[<span class="literal">1</span>].length() - <span class="literal">1</span>);}</span>
<a id="line108"></a><span class="lineno"> 108</span>
<a id="line109"></a><span class="lineno"> 109</span><span class="line">template &lt;&gt;</span>
<a id="line110"></a><span class="lineno"> 110</span><span class="line">inline <a href="../../../../Scopes/vsip/Domain.html" title="class vsip::Domain">Domain</a>&lt;2&gt;</span>
<a id="line111"></a><span class="lineno"> 111</span><span class="line"><a href="../../../../Scopes/vsip/impl.html#conv_kernel_size_Ltype_ctype_R_lconst.Domain_L_S_R_A_r" title="function vsip::impl::conv_kernel_size&lt;type,type&gt;(const Domain&lt;*&gt;&amp;)">conv_kernel_size&lt;sym_even_len_even, 2&gt;</a>(<a href="../../../../Scopes/vsip/Domain.html" title="class vsip::Domain">Domain</a>&lt;2&gt; const &amp;coeff_size) </span>
<a id="line112"></a><span class="lineno"> 112</span><span class="line">{ <span class="keyword">return</span> Domain&lt;2&gt;(<span class="literal">2</span> * <a href="" title="parameter coeff_size">coeff_size</a>[<span class="literal">0</span>].length(), <span class="literal">2</span> * <a href="" title="parameter coeff_size">coeff_size</a>[<span class="literal">1</span>].length() - <span class="literal">1</span>);}</span>
<a id="line113"></a><span class="lineno"> 113</span>
<a id="line114"></a><span class="lineno"> 114</span><span class="line">template &lt;&gt;</span>
<a id="line115"></a><span class="lineno"> 115</span><span class="line">inline <a href="../../../../Scopes/vsip/Domain.html" title="class vsip::Domain">Domain</a>&lt;2&gt;</span>
<a id="line116"></a><span class="lineno"> 116</span><span class="line"><a href="../../../../Scopes/vsip/impl.html#conv_kernel_size_Ltype_ctype_R_lconst.Domain_L_S_R_A_r" title="function vsip::impl::conv_kernel_size&lt;type,type&gt;(const Domain&lt;*&gt;&amp;)">conv_kernel_size&lt;nonsym, 2&gt;</a>(<a href="../../../../Scopes/vsip/Domain.html" title="class vsip::Domain">Domain</a>&lt;2&gt; const &amp;coeff_size) </span>
<a id="line117"></a><span class="lineno"> 117</span><span class="line">{ <span class="keyword">return</span> Domain&lt;2&gt;(<a href="" title="parameter coeff_size">coeff_size</a>[<span class="literal">0</span>].length(), <a href="" title="parameter coeff_size">coeff_size</a>[<span class="literal">1</span>].length());}</span>
<a id="line118"></a><span class="lineno"> 118</span>
<a id="line119"></a><span class="lineno"> 119</span>
<a id="line120"></a><span class="lineno"> 120</span>
<a id="line121"></a><span class="lineno"> 121</span><span class="line"><span class="comment">/// Helper function to determine the output_size of a convolution</span></span>
<a id="line122"></a><span class="lineno"> 122</span><span class="line"><span class="comment">/// for a single dimension.</span></span>
<a id="line123"></a><span class="lineno"> 123</span>
<a id="line124"></a><span class="lineno"> 124</span><span class="line">inline <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a></span>
<a id="line125"></a><span class="lineno"> 125</span><span class="line"><a href="../../../../Scopes/vsip/impl.html#conv_dim_output_size_lsupport_region_type_clength_type_clength_type_clength_type_r" title="function vsip::impl::conv_dim_output_size(support_region_type,length_type,length_type,length_type)">conv_dim_output_size</a>(</span>
<a id="line126"></a><span class="lineno"> 126</span><span class="line">  <a href="../../../../Scopes/vsip.html#support_region_type" title="enum vsip::support_region_type">support_region_type</a> supp,</span>
<a id="line127"></a><span class="lineno"> 127</span><span class="line">  <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a>         M,    <span class="comment">// kernel length</span></span>
<a id="line128"></a><span class="lineno"> 128</span><span class="line">  <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a>         N,    <span class="comment">// input  length</span></span>
<a id="line129"></a><span class="lineno"> 129</span><span class="line">  <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a>         D)    <span class="comment">// decimation factor</span></span>
<a id="line130"></a><span class="lineno"> 130</span><span class="line">{</span>
<a id="line131"></a><span class="lineno"> 131</span><span class="line">  <span class="keyword">if</span>      (<a href="" title="parameter supp">supp</a> == <a href="../../../../Scopes/vsip.html#support_full" title="enumerator vsip::support_full">support_full</a>)</span>
<a id="line132"></a><span class="lineno"> 132</span><span class="line">    <span class="keyword">return</span> ((<a href="" title="parameter N">N</a> + <a href="" title="parameter M">M</a> - <span class="literal">2</span>)/<a href="" title="parameter D">D</a>) + <span class="literal">1</span>;</span>
<a id="line133"></a><span class="lineno"> 133</span><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> (<a href="" title="parameter supp">supp</a> == <a href="../../../../Scopes/vsip.html#support_same" title="enumerator vsip::support_same">support_same</a>)</span>
<a id="line134"></a><span class="lineno"> 134</span><span class="line">    <span class="keyword">return</span> ((<a href="" title="parameter N">N</a> - <span class="literal">1</span>)/<a href="" title="parameter D">D</a>) + <span class="literal">1</span>;</span>
<a id="line135"></a><span class="lineno"> 135</span><span class="line">  <span class="keyword">else</span> //(supp == support_min)</span>
<a id="line136"></a><span class="lineno"> 136</span><span class="line">  {</span>
<a id="line137"></a><span class="lineno"> 137</span><span class="line">#if VSIP_IMPL_CONV_CORRECT_MIN_SUPPORT_SIZE</span>
<a id="line138"></a><span class="lineno"> 138</span><span class="line">    <span class="keyword">return</span> ((<a href="" title="parameter N">N</a> - <a href="" title="parameter M">M</a> + <span class="literal">1</span>) / <a href="" title="parameter D">D</a>) + ((<a href="" title="parameter N">N</a> - <a href="" title="parameter M">M</a> + <span class="literal">1</span>) % <a href="" title="parameter D">D</a> == <span class="literal">0</span> ? <span class="literal">0</span> : <span class="literal">1</span>);</span>
<a id="line139"></a><span class="lineno"> 139</span><span class="line">#else</span>
<a id="line140"></a><span class="lineno"> 140</span><span class="line">    return ((N - 1)/D) - ((M-1)/D) + 1;</span>
<a id="line141"></a><span class="lineno"> 141</span><span class="line">#endif</span>
<a id="line142"></a><span class="lineno"> 142</span><span class="line">  }</span>
<a id="line143"></a><span class="lineno"> 143</span><span class="line">}</span>
<a id="line144"></a><span class="lineno"> 144</span>
<a id="line145"></a><span class="lineno"> 145</span>
<a id="line146"></a><span class="lineno"> 146</span>
<a id="line147"></a><span class="lineno"> 147</span><span class="line"><span class="comment">/// Helper function to determine the output_size of a convolution.</span></span>
<a id="line148"></a><span class="lineno"> 148</span>
<a id="line149"></a><span class="lineno"> 149</span><span class="line">template &lt;dimension_type Dim&gt;</span>
<a id="line150"></a><span class="lineno"> 150</span><span class="line"><a href="../../../../Scopes/vsip/Domain.html" title="class vsip::Domain">Domain</a>&lt;Dim&gt;</span>
<a id="line151"></a><span class="lineno"> 151</span><span class="line"><a href="../../../../Scopes/vsip/impl.html#conv_output_size_lsupport_region_type_cconst.Domain_LDim_R_A_cconst.Domain_LDim_R_A_clength_type_r" title="function template vsip::impl::conv_output_size(support_region_type,const Domain&lt;Dim&gt;&amp;,const Domain&lt;Dim&gt;&amp;,length_type)">conv_output_size</a>(</span>
<a id="line152"></a><span class="lineno"> 152</span><span class="line">  <a href="../../../../Scopes/vsip.html#support_region_type" title="enum vsip::support_region_type">support_region_type</a> supp,</span>
<a id="line153"></a><span class="lineno"> 153</span><span class="line">  <a href="../../../../Scopes/vsip/Domain.html" title="class vsip::Domain">Domain</a>&lt;Dim&gt; const&amp;  kernel,</span>
<a id="line154"></a><span class="lineno"> 154</span><span class="line">  <a href="../../../../Scopes/vsip/Domain.html" title="class vsip::Domain">Domain</a>&lt;Dim&gt; const&amp;  input,</span>
<a id="line155"></a><span class="lineno"> 155</span><span class="line">  <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a>         dec)    <span class="comment">// decimation factor</span></span>
<a id="line156"></a><span class="lineno"> 156</span><span class="line">{</span>
<a id="line157"></a><span class="lineno"> 157</span><span class="line">  <a href="../../../../Scopes/vsip/Domain.html" title="class vsip::Domain">Domain</a>&lt;1&gt; <a href="" title="local variable dom">dom</a>[Dim];</span>
<a id="line158"></a><span class="lineno"> 158</span>
<a id="line159"></a><span class="lineno"> 159</span><span class="line">  <span class="keyword">for</span> (<a href="../../../../Scopes/vsip.html#dimension_type" title="typedef vsip::dimension_type">dimension_type</a> <a href="" title="local variable `for::d">d</a>=<span class="literal">0</span>; <a href="" title="local variable `for::d">d</a>&lt;Dim; ++<a href="" title="local variable `for::d">d</a>)</span>
<a id="line160"></a><span class="lineno"> 160</span><span class="line">    <a href="" title="local variable dom">dom</a>[<a href="" title="local variable `for::d">d</a>] = Domain&lt;1&gt;(<a href="../../../../Scopes/vsip/impl.html#conv_dim_output_size_lsupport_region_type_clength_type_clength_type_clength_type_r" title="function vsip::impl::conv_dim_output_size(support_region_type,length_type,length_type,length_type)">conv_dim_output_size</a>(<a href="" title="parameter supp">supp</a>, <a href="" title="parameter kernel">kernel</a>[<a href="" title="local variable `for::d">d</a>].size(),</span>
<a id="line161"></a><span class="lineno"> 161</span><span class="line">					    <a href="" title="parameter input">input</a>[<a href="" title="local variable `for::d">d</a>].size(),</span>
<a id="line162"></a><span class="lineno"> 162</span><span class="line">					    <a href="" title="parameter dec">dec</a>));</span>
<a id="line163"></a><span class="lineno"> 163</span><span class="line">  <span class="keyword">return</span> <a href="../../../../Scopes/vsip/impl.html#construct_domain_lconst.Domain_L_S_R_S_r" title="function template vsip::impl::construct_domain(const Domain&lt;*&gt;*)">construct_domain&lt;Dim&gt;</a>(<a href="" title="local variable dom">dom</a>);</span>
<a id="line164"></a><span class="lineno"> 164</span><span class="line">}</span>
<a id="line165"></a><span class="lineno"> 165</span>
<a id="line166"></a><span class="lineno"> 166</span>
<a id="line167"></a><span class="lineno"> 167</span>
<a id="line168"></a><span class="lineno"> 168</span><span class="line"><span class="comment">/// Helper function to determine a 1-D convolution's kernel from its</span></span>
<a id="line169"></a><span class="lineno"> 169</span><span class="line"><span class="comment">/// symmetry and coefficients.</span></span>
<a id="line170"></a><span class="lineno"> 170</span>
<a id="line171"></a><span class="lineno"> 171</span><span class="line">template &lt;typename CoeffViewT,</span>
<a id="line172"></a><span class="lineno"> 172</span><span class="line">	  typename T,</span>
<a id="line173"></a><span class="lineno"> 173</span><span class="line">	  typename BlockT&gt;</span>
<a id="line174"></a><span class="lineno"> 174</span><span class="line">CoeffViewT</span>
<a id="line175"></a><span class="lineno"> 175</span><span class="line"><a href="../../../../Scopes/vsip/impl.html#conv_kernel_lsymmetry_type_cconst_Vector_LT_cBlockT_R_r" title="function template vsip::impl::conv_kernel(symmetry_type,const_Vector&lt;T,BlockT&gt;)">conv_kernel</a>(<a href="../../../../Scopes/vsip.html#symmetry_type" title="enum vsip::symmetry_type">symmetry_type</a> sym, <a href="../../../../Scopes/vsip/const_Vector.html" title="class vsip::const_Vector">const_Vector</a>&lt;T, BlockT&gt; coeff)</span>
<a id="line176"></a><span class="lineno"> 176</span><span class="line">{</span>
<a id="line177"></a><span class="lineno"> 177</span><span class="line">  <span class="keyword">if</span> (<a href="" title="parameter sym">sym</a> == <a href="../../../../Scopes/vsip.html#sym_even_len_odd" title="enumerator vsip::sym_even_len_odd">sym_even_len_odd</a>)</span>
<a id="line178"></a><span class="lineno"> 178</span><span class="line">  {</span>
<a id="line179"></a><span class="lineno"> 179</span><span class="line">    <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a> <a href="" title="local variable `if::M">M</a> = <a href="" title="parameter coeff">coeff</a>.size(<span class="literal">0</span>);</span>
<a id="line180"></a><span class="lineno"> 180</span><span class="line">    CoeffViewT <a href="" title="local variable `if::full_coeff">full_coeff</a>(2*M-1);</span>
<a id="line181"></a><span class="lineno"> 181</span><span class="line">    assign_local(full_coeff(Domain&lt;1&gt;(<span class="literal">0</span>, <span class="literal">1</span>, <a href="" title="local variable `if::M">M</a>))  , <a href="" title="parameter coeff">coeff</a>);</span>
<a id="line182"></a><span class="lineno"> 182</span><span class="line">    assign_local(full_coeff(Domain&lt;1&gt;(<a href="" title="local variable `if::M">M</a>, <span class="literal">1</span>, <a href="" title="local variable `if::M">M</a>-<span class="literal">1</span>)), coeff(Domain&lt;1&gt;(<a href="" title="local variable `if::M">M</a>-<span class="literal">2</span>, -<span class="literal">1</span>, <a href="" title="local variable `if::M">M</a>-<span class="literal">1</span>)));</span>
<a id="line183"></a><span class="lineno"> 183</span><span class="line">    <span class="keyword">return</span> <a href="" title="local variable `if::full_coeff">full_coeff</a>;</span>
<a id="line184"></a><span class="lineno"> 184</span><span class="line">  }</span>
<a id="line185"></a><span class="lineno"> 185</span><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> (<a href="" title="parameter sym">sym</a> == <a href="../../../../Scopes/vsip.html#sym_even_len_even" title="enumerator vsip::sym_even_len_even">sym_even_len_even</a>)</span>
<a id="line186"></a><span class="lineno"> 186</span><span class="line">  {</span>
<a id="line187"></a><span class="lineno"> 187</span><span class="line">    <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a> <a href="" title="local variable `else::`if::M">M</a> = <a href="" title="parameter coeff">coeff</a>.size(<span class="literal">0</span>);</span>
<a id="line188"></a><span class="lineno"> 188</span><span class="line">    CoeffViewT <a href="" title="local variable `else::`if::full_coeff">full_coeff</a>(2*M);</span>
<a id="line189"></a><span class="lineno"> 189</span><span class="line">    assign_local(full_coeff(Domain&lt;1&gt;(<span class="literal">0</span>, <span class="literal">1</span>, <a href="" title="local variable `else::`if::M">M</a>)), <a href="" title="parameter coeff">coeff</a>);</span>
<a id="line190"></a><span class="lineno"> 190</span><span class="line">    assign_local(full_coeff(Domain&lt;1&gt;(<a href="" title="local variable `else::`if::M">M</a>, <span class="literal">1</span>, <a href="" title="local variable `else::`if::M">M</a>)), coeff(Domain&lt;1&gt;(<a href="" title="local variable `else::`if::M">M</a>-<span class="literal">1</span>, -<span class="literal">1</span>, <a href="" title="local variable `else::`if::M">M</a>)));</span>
<a id="line191"></a><span class="lineno"> 191</span><span class="line">    <span class="keyword">return</span> <a href="" title="local variable `else::`if::full_coeff">full_coeff</a>;</span>
<a id="line192"></a><span class="lineno"> 192</span><span class="line">  }</span>
<a id="line193"></a><span class="lineno"> 193</span><span class="line">  <span class="keyword">else</span> /* (sym == nonsym) */</span>
<a id="line194"></a><span class="lineno"> 194</span><span class="line">  {</span>
<a id="line195"></a><span class="lineno"> 195</span><span class="line">    <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a> <a href="" title="local variable `else::`else::M">M</a> = <a href="" title="parameter coeff">coeff</a>.size(<span class="literal">0</span>);</span>
<a id="line196"></a><span class="lineno"> 196</span><span class="line">    CoeffViewT <a href="" title="local variable `else::`else::full_coeff">full_coeff</a>(M);</span>
<a id="line197"></a><span class="lineno"> 197</span><span class="line">    assign_local(<a href="" title="local variable `else::`else::full_coeff">full_coeff</a>, <a href="" title="parameter coeff">coeff</a>);</span>
<a id="line198"></a><span class="lineno"> 198</span><span class="line">    <span class="keyword">return</span> <a href="" title="local variable `else::`else::full_coeff">full_coeff</a>;</span>
<a id="line199"></a><span class="lineno"> 199</span><span class="line">  }</span>
<a id="line200"></a><span class="lineno"> 200</span><span class="line">}</span>
<a id="line201"></a><span class="lineno"> 201</span>
<a id="line202"></a><span class="lineno"> 202</span>
<a id="line203"></a><span class="lineno"> 203</span>
<a id="line204"></a><span class="lineno"> 204</span><span class="line"><span class="comment">/// Helper function to determine a 2-D convolution's kernel from its</span></span>
<a id="line205"></a><span class="lineno"> 205</span><span class="line"><span class="comment">/// symmetry and coefficients.</span></span>
<a id="line206"></a><span class="lineno"> 206</span>
<a id="line207"></a><span class="lineno"> 207</span><span class="line">template &lt;typename CoeffViewT,</span>
<a id="line208"></a><span class="lineno"> 208</span><span class="line">	  typename T,</span>
<a id="line209"></a><span class="lineno"> 209</span><span class="line">	  typename BlockT&gt;</span>
<a id="line210"></a><span class="lineno"> 210</span><span class="line">CoeffViewT</span>
<a id="line211"></a><span class="lineno"> 211</span><span class="line"><a href="../../../../Scopes/vsip/impl.html#conv_kernel_lsymmetry_type_cconst_Matrix_LT_cBlockT_R_r" title="function template vsip::impl::conv_kernel(symmetry_type,const_Matrix&lt;T,BlockT&gt;)">conv_kernel</a>(<a href="../../../../Scopes/vsip.html#symmetry_type" title="enum vsip::symmetry_type">symmetry_type</a> sym, <a href="../../../../Scopes/vsip/const_Matrix.html" title="class vsip::const_Matrix">const_Matrix</a>&lt;T, BlockT&gt; coeff)</span>
<a id="line212"></a><span class="lineno"> 212</span><span class="line">{</span>
<a id="line213"></a><span class="lineno"> 213</span><span class="line">  <span class="keyword">if</span> (<a href="" title="parameter sym">sym</a> == <a href="../../../../Scopes/vsip.html#sym_even_len_odd" title="enumerator vsip::sym_even_len_odd">sym_even_len_odd</a>)</span>
<a id="line214"></a><span class="lineno"> 214</span><span class="line">  {</span>
<a id="line215"></a><span class="lineno"> 215</span><span class="line">    <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a> <a href="" title="local variable `if::Mr">Mr</a> = <a href="" title="parameter coeff">coeff</a>.size(<span class="literal">0</span>);</span>
<a id="line216"></a><span class="lineno"> 216</span><span class="line">    <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a> <a href="" title="local variable `if::Mc">Mc</a> = <a href="" title="parameter coeff">coeff</a>.size(<span class="literal">1</span>);</span>
<a id="line217"></a><span class="lineno"> 217</span><span class="line">    CoeffViewT <a href="" title="local variable `if::full_coeff">full_coeff</a>(2*Mr-1, 2*Mc-1);</span>
<a id="line218"></a><span class="lineno"> 218</span>
<a id="line219"></a><span class="lineno"> 219</span><span class="line">    // fill upper-left</span>
<a id="line220"></a><span class="lineno"> 220</span><span class="line">    full_coeff(Domain&lt;2&gt;(Domain&lt;1&gt;(<span class="literal">0</span>, <span class="literal">1</span>, <a href="" title="local variable `if::Mr">Mr</a>), Domain&lt;1&gt;(<span class="literal">0</span>, <span class="literal">1</span>, <a href="" title="local variable `if::Mc">Mc</a>))) = <a href="" title="parameter coeff">coeff</a>;</span>
<a id="line221"></a><span class="lineno"> 221</span>
<a id="line222"></a><span class="lineno"> 222</span><span class="line">    // fill upper-right</span>
<a id="line223"></a><span class="lineno"> 223</span><span class="line">    full_coeff(Domain&lt;2&gt;(Domain&lt;1&gt;(<span class="literal">0</span>, <span class="literal">1</span>, <a href="" title="local variable `if::Mr">Mr</a>), Domain&lt;1&gt;(<a href="" title="local variable `if::Mc">Mc</a>, <span class="literal">1</span>, <a href="" title="local variable `if::Mc">Mc</a>-<span class="literal">1</span>))) =</span>
<a id="line224"></a><span class="lineno"> 224</span><span class="line">      coeff(Domain&lt;2&gt;(<a href="" title="local variable `if::Mr">Mr</a>, Domain&lt;1&gt;(<a href="" title="local variable `if::Mc">Mc</a>-<span class="literal">2</span>, -<span class="literal">1</span>, <a href="" title="local variable `if::Mc">Mc</a>-<span class="literal">1</span>)));</span>
<a id="line225"></a><span class="lineno"> 225</span>
<a id="line226"></a><span class="lineno"> 226</span><span class="line">    // fill lower-right (by folding over)</span>
<a id="line227"></a><span class="lineno"> 227</span><span class="line">    full_coeff(Domain&lt;2&gt;(Domain&lt;1&gt;(<a href="" title="local variable `if::Mr">Mr</a>, <span class="literal">1</span>, <a href="" title="local variable `if::Mr">Mr</a>-<span class="literal">1</span>), <span class="literal">2</span>*<a href="" title="local variable `if::Mc">Mc</a>-<span class="literal">1</span>)) =</span>
<a id="line228"></a><span class="lineno"> 228</span><span class="line">      full_coeff(Domain&lt;2&gt;(Domain&lt;1&gt;(<a href="" title="local variable `if::Mr">Mr</a>-<span class="literal">2</span>, -<span class="literal">1</span>, <a href="" title="local variable `if::Mr">Mr</a>-<span class="literal">1</span>), <span class="literal">2</span>*<a href="" title="local variable `if::Mc">Mc</a>-<span class="literal">1</span>));</span>
<a id="line229"></a><span class="lineno"> 229</span>
<a id="line230"></a><span class="lineno"> 230</span><span class="line">    <span class="keyword">return</span> <a href="" title="local variable `if::full_coeff">full_coeff</a>;</span>
<a id="line231"></a><span class="lineno"> 231</span><span class="line">  }</span>
<a id="line232"></a><span class="lineno"> 232</span><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> (<a href="" title="parameter sym">sym</a> == <a href="../../../../Scopes/vsip.html#sym_even_len_even" title="enumerator vsip::sym_even_len_even">sym_even_len_even</a>)</span>
<a id="line233"></a><span class="lineno"> 233</span><span class="line">  {</span>
<a id="line234"></a><span class="lineno"> 234</span><span class="line">    <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a> <a href="" title="local variable `else::`if::Mr">Mr</a> = <a href="" title="parameter coeff">coeff</a>.size(<span class="literal">0</span>);</span>
<a id="line235"></a><span class="lineno"> 235</span><span class="line">    <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a> <a href="" title="local variable `else::`if::Mc">Mc</a> = <a href="" title="parameter coeff">coeff</a>.size(<span class="literal">1</span>);</span>
<a id="line236"></a><span class="lineno"> 236</span><span class="line">    CoeffViewT <a href="" title="local variable `else::`if::full_coeff">full_coeff</a>(2*Mr, 2*Mc);</span>
<a id="line237"></a><span class="lineno"> 237</span>
<a id="line238"></a><span class="lineno"> 238</span><span class="line">    // fill upper-left</span>
<a id="line239"></a><span class="lineno"> 239</span><span class="line">    full_coeff(Domain&lt;2&gt;(<a href="" title="local variable `else::`if::Mr">Mr</a>, <a href="" title="local variable `else::`if::Mc">Mc</a>)) = <a href="" title="parameter coeff">coeff</a>;</span>
<a id="line240"></a><span class="lineno"> 240</span>
<a id="line241"></a><span class="lineno"> 241</span><span class="line">    // fill upper-right</span>
<a id="line242"></a><span class="lineno"> 242</span><span class="line">    full_coeff(Domain&lt;2&gt;(<a href="" title="local variable `else::`if::Mr">Mr</a>, Domain&lt;1&gt;(<a href="" title="local variable `else::`if::Mc">Mc</a>, <span class="literal">1</span>, <a href="" title="local variable `else::`if::Mc">Mc</a>))) =</span>
<a id="line243"></a><span class="lineno"> 243</span><span class="line">      coeff(Domain&lt;2&gt;(<a href="" title="local variable `else::`if::Mr">Mr</a>, Domain&lt;1&gt;(<a href="" title="local variable `else::`if::Mc">Mc</a>-<span class="literal">1</span>, -<span class="literal">1</span>, <a href="" title="local variable `else::`if::Mc">Mc</a>)));</span>
<a id="line244"></a><span class="lineno"> 244</span>
<a id="line245"></a><span class="lineno"> 245</span><span class="line">    // fill lower-right (by folding over)</span>
<a id="line246"></a><span class="lineno"> 246</span><span class="line">    full_coeff(Domain&lt;2&gt;(Domain&lt;1&gt;(<a href="" title="local variable `else::`if::Mr">Mr</a>, <span class="literal">1</span>, <a href="" title="local variable `else::`if::Mr">Mr</a>), <span class="literal">2</span>*<a href="" title="local variable `else::`if::Mc">Mc</a>)) =</span>
<a id="line247"></a><span class="lineno"> 247</span><span class="line">      full_coeff(Domain&lt;2&gt;(Domain&lt;1&gt;(<a href="" title="local variable `else::`if::Mr">Mr</a>-<span class="literal">1</span>, -<span class="literal">1</span>, <a href="" title="local variable `else::`if::Mr">Mr</a>), <span class="literal">2</span>*<a href="" title="local variable `else::`if::Mc">Mc</a>));</span>
<a id="line248"></a><span class="lineno"> 248</span>
<a id="line249"></a><span class="lineno"> 249</span><span class="line">    <span class="keyword">return</span> <a href="" title="local variable `else::`if::full_coeff">full_coeff</a>;</span>
<a id="line250"></a><span class="lineno"> 250</span><span class="line">  }</span>
<a id="line251"></a><span class="lineno"> 251</span><span class="line">  <span class="keyword">else</span> /* (sym == nonsym) */</span>
<a id="line252"></a><span class="lineno"> 252</span><span class="line">  {</span>
<a id="line253"></a><span class="lineno"> 253</span><span class="line">    <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a> <a href="" title="local variable `else::`else::Mr">Mr</a> = <a href="" title="parameter coeff">coeff</a>.size(<span class="literal">0</span>);</span>
<a id="line254"></a><span class="lineno"> 254</span><span class="line">    <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a> <a href="" title="local variable `else::`else::Mc">Mc</a> = <a href="" title="parameter coeff">coeff</a>.size(<span class="literal">1</span>);</span>
<a id="line255"></a><span class="lineno"> 255</span><span class="line">    CoeffViewT <a href="" title="local variable `else::`else::full_coeff">full_coeff</a>(Mr, Mc);</span>
<a id="line256"></a><span class="lineno"> 256</span><span class="line">    <a href="" title="local variable `else::`else::full_coeff">full_coeff</a> = <a href="" title="parameter coeff">coeff</a>;</span>
<a id="line257"></a><span class="lineno"> 257</span><span class="line">    <span class="keyword">return</span> <a href="" title="local variable `else::`else::full_coeff">full_coeff</a>;</span>
<a id="line258"></a><span class="lineno"> 258</span><span class="line">  }</span>
<a id="line259"></a><span class="lineno"> 259</span><span class="line">}</span>
<a id="line260"></a><span class="lineno"> 260</span>
<a id="line261"></a><span class="lineno"> 261</span>
<a id="line262"></a><span class="lineno"> 262</span>
<a id="line263"></a><span class="lineno"> 263</span><span class="line"><span class="comment">/***********************************************************************</span></span>
<a id="line264"></a><span class="lineno"> 264</span><span class="line"><span class="comment">  1-D Convolutions (interleaved)</span></span>
<a id="line265"></a><span class="lineno"> 265</span><span class="line"><span class="comment">***********************************************************************/</span></span>
<a id="line266"></a><span class="lineno"> 266</span>
<a id="line267"></a><span class="lineno"> 267</span><span class="line"><span class="comment">/// Perform 1-D convolution with full region of support.</span></span>
<a id="line268"></a><span class="lineno"> 268</span>
<a id="line269"></a><span class="lineno"> 269</span><span class="line">template &lt;typename T&gt;</span>
<a id="line270"></a><span class="lineno"> 270</span><span class="line">inline <span class="keyword">void</span></span>
<a id="line271"></a><span class="lineno"> 271</span><span class="line"><a href="../../../../Scopes/vsip/impl.html#conv_full_lT_S_clength_type_cT_S_clength_type_cstride_type_cT_S_clength_type_cstride_type_clength_type_r" title="function template vsip::impl::conv_full(T*,length_type,T*,length_type,stride_type,T*,length_type,stride_type,length_type)">conv_full</a>(</span>
<a id="line272"></a><span class="lineno"> 272</span><span class="line">  T*          coeff,</span>
<a id="line273"></a><span class="lineno"> 273</span><span class="line">  <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a> coeff_size,	<span class="comment">// M</span></span>
<a id="line274"></a><span class="lineno"> 274</span><span class="line">  T*          in,</span>
<a id="line275"></a><span class="lineno"> 275</span><span class="line">  <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a> in_size,		<span class="comment">// N</span></span>
<a id="line276"></a><span class="lineno"> 276</span><span class="line">  <a href="../../../../Scopes/vsip.html#stride_type" title="typedef vsip::stride_type">stride_type</a> in_stride,</span>
<a id="line277"></a><span class="lineno"> 277</span><span class="line">  T*          out,</span>
<a id="line278"></a><span class="lineno"> 278</span><span class="line">  <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a> out_size,		<span class="comment">// P</span></span>
<a id="line279"></a><span class="lineno"> 279</span><span class="line">  <a href="../../../../Scopes/vsip.html#stride_type" title="typedef vsip::stride_type">stride_type</a> out_stride,</span>
<a id="line280"></a><span class="lineno"> 280</span><span class="line">  <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a> decimation)</span>
<a id="line281"></a><span class="lineno"> 281</span><span class="line">{</span>
<a id="line282"></a><span class="lineno"> 282</span><span class="line">  <span class="keyword">typedef</span> <a href="../../../../Scopes/vsip/impl/Convolution_accum_trait.html#sum_type" title="typedef vsip::impl::Convolution_accum_trait::sum_type">typename Convolution_accum_trait&lt;T&gt;::sum_type</a> <a href="" title="typedef sum_type">sum_type</a>;</span>
<a id="line283"></a><span class="lineno"> 283</span>
<a id="line284"></a><span class="lineno"> 284</span><span class="line">  <span class="keyword">for</span> (<a href="../../../../Scopes/vsip.html#index_type" title="typedef vsip::index_type">index_type</a> <a href="" title="local variable `for::n">n</a>=<span class="literal">0</span>; <a href="" title="local variable `for::n">n</a>&lt;<a href="" title="parameter out_size">out_size</a>; ++<a href="" title="local variable `for::n">n</a>)</span>
<a id="line285"></a><span class="lineno"> 285</span><span class="line">  {</span>
<a id="line286"></a><span class="lineno"> 286</span><span class="line">    <a href="" title="typedef sum_type">sum_type</a> <a href="" title="local variable `for::sum">sum</a> = sum_type();</span>
<a id="line287"></a><span class="lineno"> 287</span><span class="line">      </span>
<a id="line288"></a><span class="lineno"> 288</span><span class="line">    <span class="keyword">for</span> (<a href="../../../../Scopes/vsip.html#index_type" title="typedef vsip::index_type">index_type</a> <a href="" title="local variable `for::`for::k">k</a>=<span class="literal">0</span>; <a href="" title="local variable `for::`for::k">k</a>&lt;<a href="" title="parameter coeff_size">coeff_size</a>; ++<a href="" title="local variable `for::`for::k">k</a>)</span>
<a id="line289"></a><span class="lineno"> 289</span><span class="line">    {</span>
<a id="line290"></a><span class="lineno"> 290</span><span class="line">      <span class="keyword">if</span> (<a href="" title="local variable `for::n">n</a>*<a href="" title="parameter decimation">decimation</a> &gt;= <a href="" title="local variable `for::`for::k">k</a> &amp;&amp; <a href="" title="local variable `for::n">n</a>*<a href="" title="parameter decimation">decimation</a>-<a href="" title="local variable `for::`for::k">k</a> &lt; <a href="" title="parameter in_size">in_size</a>)</span>
<a id="line291"></a><span class="lineno"> 291</span><span class="line">	<a href="" title="local variable `for::sum">sum</a> += <a href="" title="parameter coeff">coeff</a>[<a href="" title="local variable `for::`for::k">k</a>] * <a href="" title="parameter in">in</a>[(<a href="" title="local variable `for::n">n</a>*<a href="" title="parameter decimation">decimation</a>-<a href="" title="local variable `for::`for::k">k</a>) * <a href="" title="parameter in_stride">in_stride</a>];</span>
<a id="line292"></a><span class="lineno"> 292</span><span class="line">    }</span>
<a id="line293"></a><span class="lineno"> 293</span><span class="line">    <a href="" title="parameter out">out</a>[<a href="" title="local variable `for::n">n</a> * <a href="" title="parameter out_stride">out_stride</a>] = <a href="" title="local variable `for::sum">sum</a>;</span>
<a id="line294"></a><span class="lineno"> 294</span><span class="line">  }</span>
<a id="line295"></a><span class="lineno"> 295</span><span class="line">}</span>
<a id="line296"></a><span class="lineno"> 296</span>
<a id="line297"></a><span class="lineno"> 297</span>
<a id="line298"></a><span class="lineno"> 298</span>
<a id="line299"></a><span class="lineno"> 299</span><span class="line"><span class="comment">/// Perform 1-D convolution with same region of support.</span></span>
<a id="line300"></a><span class="lineno"> 300</span>
<a id="line301"></a><span class="lineno"> 301</span><span class="line">template &lt;typename T&gt;</span>
<a id="line302"></a><span class="lineno"> 302</span><span class="line">inline <span class="keyword">void</span></span>
<a id="line303"></a><span class="lineno"> 303</span><span class="line"><a href="../../../../Scopes/vsip/impl.html#conv_same_lT_S_clength_type_cT_S_clength_type_cstride_type_cT_S_clength_type_cstride_type_clength_type_r" title="function template vsip::impl::conv_same(T*,length_type,T*,length_type,stride_type,T*,length_type,stride_type,length_type)">conv_same</a>(</span>
<a id="line304"></a><span class="lineno"> 304</span><span class="line">  T*          coeff,</span>
<a id="line305"></a><span class="lineno"> 305</span><span class="line">  <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a> coeff_size,	<span class="comment">// M</span></span>
<a id="line306"></a><span class="lineno"> 306</span><span class="line">  T*          in,</span>
<a id="line307"></a><span class="lineno"> 307</span><span class="line">  <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a> in_size,		<span class="comment">// N</span></span>
<a id="line308"></a><span class="lineno"> 308</span><span class="line">  <a href="../../../../Scopes/vsip.html#stride_type" title="typedef vsip::stride_type">stride_type</a> in_stride,</span>
<a id="line309"></a><span class="lineno"> 309</span><span class="line">  T*          out,</span>
<a id="line310"></a><span class="lineno"> 310</span><span class="line">  <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a> out_size,		<span class="comment">// P</span></span>
<a id="line311"></a><span class="lineno"> 311</span><span class="line">  <a href="../../../../Scopes/vsip.html#stride_type" title="typedef vsip::stride_type">stride_type</a> out_stride,</span>
<a id="line312"></a><span class="lineno"> 312</span><span class="line">  <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a> decimation)</span>
<a id="line313"></a><span class="lineno"> 313</span><span class="line">{</span>
<a id="line314"></a><span class="lineno"> 314</span><span class="line">  <span class="keyword">typedef</span> <a href="../../../../Scopes/vsip/impl/Convolution_accum_trait.html#sum_type" title="typedef vsip::impl::Convolution_accum_trait::sum_type">typename Convolution_accum_trait&lt;T&gt;::sum_type</a> <a href="" title="typedef sum_type">sum_type</a>;</span>
<a id="line315"></a><span class="lineno"> 315</span>
<a id="line316"></a><span class="lineno"> 316</span><span class="line">  <span class="keyword">for</span> (<a href="../../../../Scopes/vsip.html#index_type" title="typedef vsip::index_type">index_type</a> <a href="" title="local variable `for::n">n</a>=<span class="literal">0</span>; <a href="" title="local variable `for::n">n</a>&lt;<a href="" title="parameter out_size">out_size</a>; ++<a href="" title="local variable `for::n">n</a>)</span>
<a id="line317"></a><span class="lineno"> 317</span><span class="line">  {</span>
<a id="line318"></a><span class="lineno"> 318</span><span class="line">    <a href="" title="typedef sum_type">sum_type</a> <a href="" title="local variable `for::sum">sum</a> = sum_type();</span>
<a id="line319"></a><span class="lineno"> 319</span><span class="line">      </span>
<a id="line320"></a><span class="lineno"> 320</span><span class="line">    <span class="keyword">for</span> (<a href="../../../../Scopes/vsip.html#index_type" title="typedef vsip::index_type">index_type</a> <a href="" title="local variable `for::`for::k">k</a>=<span class="literal">0</span>; <a href="" title="local variable `for::`for::k">k</a>&lt;<a href="" title="parameter coeff_size">coeff_size</a>; ++<a href="" title="local variable `for::`for::k">k</a>)</span>
<a id="line321"></a><span class="lineno"> 321</span><span class="line">    {</span>
<a id="line322"></a><span class="lineno"> 322</span><span class="line">      <span class="keyword">if</span> (<a href="" title="local variable `for::n">n</a>*<a href="" title="parameter decimation">decimation</a> + (<a href="" title="parameter coeff_size">coeff_size</a>/<span class="literal">2</span>)   &gt;= <a href="" title="local variable `for::`for::k">k</a> &amp;&amp;</span>
<a id="line323"></a><span class="lineno"> 323</span><span class="line">	  <a href="" title="local variable `for::n">n</a>*<a href="" title="parameter decimation">decimation</a> + (<a href="" title="parameter coeff_size">coeff_size</a>/<span class="literal">2</span>)-<a href="" title="local variable `for::`for::k">k</a> &lt;  <a href="" title="parameter in_size">in_size</a>)</span>
<a id="line324"></a><span class="lineno"> 324</span><span class="line">	<a href="" title="local variable `for::sum">sum</a> += <a href="" title="parameter coeff">coeff</a>[<a href="" title="local variable `for::`for::k">k</a>] * <a href="" title="parameter in">in</a>[(<a href="" title="local variable `for::n">n</a>*<a href="" title="parameter decimation">decimation</a>+(<a href="" title="parameter coeff_size">coeff_size</a>/<span class="literal">2</span>)-<a href="" title="local variable `for::`for::k">k</a>) * <a href="" title="parameter in_stride">in_stride</a>];</span>
<a id="line325"></a><span class="lineno"> 325</span><span class="line">    }</span>
<a id="line326"></a><span class="lineno"> 326</span><span class="line">    <a href="" title="parameter out">out</a>[<a href="" title="local variable `for::n">n</a> * <a href="" title="parameter out_stride">out_stride</a>] = <a href="" title="local variable `for::sum">sum</a>;</span>
<a id="line327"></a><span class="lineno"> 327</span><span class="line">  }</span>
<a id="line328"></a><span class="lineno"> 328</span><span class="line">}</span>
<a id="line329"></a><span class="lineno"> 329</span>
<a id="line330"></a><span class="lineno"> 330</span>
<a id="line331"></a><span class="lineno"> 331</span>
<a id="line332"></a><span class="lineno"> 332</span><span class="line"><span class="comment">/// Perform 1-D convolution with minimal region of support.</span></span>
<a id="line333"></a><span class="lineno"> 333</span>
<a id="line334"></a><span class="lineno"> 334</span><span class="line">template &lt;typename T&gt;</span>
<a id="line335"></a><span class="lineno"> 335</span><span class="line">inline <span class="keyword">void</span></span>
<a id="line336"></a><span class="lineno"> 336</span><span class="line"><a href="../../../../Scopes/vsip/impl.html#conv_min_lT_S_clength_type_cT_S_clength_type_cstride_type_cT_S_clength_type_cstride_type_clength_type_r" title="function template vsip::impl::conv_min(T*,length_type,T*,length_type,stride_type,T*,length_type,stride_type,length_type)">conv_min</a>(</span>
<a id="line337"></a><span class="lineno"> 337</span><span class="line">  T*          coeff,</span>
<a id="line338"></a><span class="lineno"> 338</span><span class="line">  <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a> coeff_size,	<span class="comment">// M</span></span>
<a id="line339"></a><span class="lineno"> 339</span><span class="line">  T*          in,</span>
<a id="line340"></a><span class="lineno"> 340</span><span class="line">  <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a> in_size,		<span class="comment">// N</span></span>
<a id="line341"></a><span class="lineno"> 341</span><span class="line">  <a href="../../../../Scopes/vsip.html#stride_type" title="typedef vsip::stride_type">stride_type</a> in_stride,</span>
<a id="line342"></a><span class="lineno"> 342</span><span class="line">  T*          out,</span>
<a id="line343"></a><span class="lineno"> 343</span><span class="line">  <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a> out_size,		<span class="comment">// P</span></span>
<a id="line344"></a><span class="lineno"> 344</span><span class="line">  <a href="../../../../Scopes/vsip.html#stride_type" title="typedef vsip::stride_type">stride_type</a> out_stride,</span>
<a id="line345"></a><span class="lineno"> 345</span><span class="line">  <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a> decimation)</span>
<a id="line346"></a><span class="lineno"> 346</span><span class="line">{</span>
<a id="line347"></a><span class="lineno"> 347</span><span class="line">  <span class="keyword">typedef</span> <a href="../../../../Scopes/vsip/impl/Convolution_accum_trait.html#sum_type" title="typedef vsip::impl::Convolution_accum_trait::sum_type">typename Convolution_accum_trait&lt;T&gt;::sum_type</a> <a href="" title="typedef sum_type">sum_type</a>;</span>
<a id="line348"></a><span class="lineno"> 348</span>
<a id="line349"></a><span class="lineno"> 349</span><span class="line">#if VSIP_IMPL_CONV_CORRECT_MIN_SUPPORT_SIZE</span>
<a id="line350"></a><span class="lineno"> 350</span><span class="line">  <a href="" title="macro call">assert</a>((out_size-1)*decimation+(coeff_size-1) &lt; in_size);</span>
<a id="line351"></a><span class="lineno"> 351</span>
<a id="line352"></a><span class="lineno"> 352</span><span class="line">  <span class="keyword">for</span> (<a href="../../../../Scopes/vsip.html#index_type" title="typedef vsip::index_type">index_type</a> <a href="" title="local variable `for::n">n</a>=<span class="literal">0</span>; <a href="" title="local variable `for::n">n</a>&lt;<a href="" title="parameter out_size">out_size</a>; ++<a href="" title="local variable `for::n">n</a>)</span>
<a id="line353"></a><span class="lineno"> 353</span><span class="line">  {</span>
<a id="line354"></a><span class="lineno"> 354</span><span class="line">    <a href="" title="typedef sum_type">sum_type</a> <a href="" title="local variable `for::sum">sum</a> = sum_type();</span>
<a id="line355"></a><span class="lineno"> 355</span><span class="line">      </span>
<a id="line356"></a><span class="lineno"> 356</span><span class="line">    <a href="../../../../Scopes/vsip.html#index_type" title="typedef vsip::index_type">index_type</a> <a href="" title="local variable `for::offset">offset</a> = <a href="" title="local variable `for::n">n</a>*<a href="" title="parameter decimation">decimation</a>+(<a href="" title="parameter coeff_size">coeff_size</a>-<span class="literal">1</span>);</span>
<a id="line357"></a><span class="lineno"> 357</span><span class="line">    <span class="keyword">for</span> (<a href="../../../../Scopes/vsip.html#index_type" title="typedef vsip::index_type">index_type</a> <a href="" title="local variable `for::`for::k">k</a>=<span class="literal">0</span>; <a href="" title="local variable `for::`for::k">k</a>&lt;<a href="" title="parameter coeff_size">coeff_size</a>; ++<a href="" title="local variable `for::`for::k">k</a>)</span>
<a id="line358"></a><span class="lineno"> 358</span><span class="line">    {</span>
<a id="line359"></a><span class="lineno"> 359</span><span class="line">      <a href="" title="local variable `for::sum">sum</a> += <a href="" title="parameter coeff">coeff</a>[<a href="" title="local variable `for::`for::k">k</a>] * <a href="" title="parameter in">in</a>[(<a href="" title="local variable `for::offset">offset</a>-<a href="" title="local variable `for::`for::k">k</a>) * <a href="" title="parameter in_stride">in_stride</a>];</span>
<a id="line360"></a><span class="lineno"> 360</span><span class="line">    }</span>
<a id="line361"></a><span class="lineno"> 361</span><span class="line">    <a href="" title="parameter out">out</a>[<a href="" title="local variable `for::n">n</a> * <a href="" title="parameter out_stride">out_stride</a>] = <a href="" title="local variable `for::sum">sum</a>;</span>
<a id="line362"></a><span class="lineno"> 362</span><span class="line">  }</span>
<a id="line363"></a><span class="lineno"> 363</span><span class="line">#else</span>
<a id="line364"></a><span class="lineno"> 364</span><span class="line">  for (index_type n=0; n&lt;out_size; ++n)</span>
<a id="line365"></a><span class="lineno"> 365</span><span class="line">  {</span>
<a id="line366"></a><span class="lineno"> 366</span><span class="line">    sum_type sum = sum_type();</span>
<a id="line367"></a><span class="lineno"> 367</span><span class="line">      </span>
<a id="line368"></a><span class="lineno"> 368</span><span class="line">    index_type offset = n*decimation+(coeff_size-1);</span>
<a id="line369"></a><span class="lineno"> 369</span><span class="line">    for (index_type k=0; k&lt;coeff_size; ++k)</span>
<a id="line370"></a><span class="lineno"> 370</span><span class="line">    {</span>
<a id="line371"></a><span class="lineno"> 371</span><span class="line">      if (offset-k &lt; in_size)</span>
<a id="line372"></a><span class="lineno"> 372</span><span class="line">	sum += coeff[k] * in[(offset-k) * in_stride];</span>
<a id="line373"></a><span class="lineno"> 373</span><span class="line">    }</span>
<a id="line374"></a><span class="lineno"> 374</span><span class="line">    out[n * out_stride] = sum;</span>
<a id="line375"></a><span class="lineno"> 375</span><span class="line">  }</span>
<a id="line376"></a><span class="lineno"> 376</span><span class="line">#endif</span>
<a id="line377"></a><span class="lineno"> 377</span><span class="line">}</span>
<a id="line378"></a><span class="lineno"> 378</span>
<a id="line379"></a><span class="lineno"> 379</span>
<a id="line380"></a><span class="lineno"> 380</span>
<a id="line381"></a><span class="lineno"> 381</span><span class="line"><span class="comment">/***********************************************************************</span></span>
<a id="line382"></a><span class="lineno"> 382</span><span class="line"><span class="comment">  1-D Convolutions (split)</span></span>
<a id="line383"></a><span class="lineno"> 383</span><span class="line"><span class="comment">***********************************************************************/</span></span>
<a id="line384"></a><span class="lineno"> 384</span>
<a id="line385"></a><span class="lineno"> 385</span><span class="line"><span class="comment">/// Perform 1-D convolution with full region of support.</span></span>
<a id="line386"></a><span class="lineno"> 386</span>
<a id="line387"></a><span class="lineno"> 387</span><span class="line">template &lt;typename T&gt;</span>
<a id="line388"></a><span class="lineno"> 388</span><span class="line">inline <span class="keyword">void</span></span>
<a id="line389"></a><span class="lineno"> 389</span><span class="line"><a href="" title="function template vsip::impl::conv_full(std::pair&lt;T*,T*&gt;,length_type,std::pair&lt;T*,T*&gt;,length_type,stride_type,std::pair&lt;T*,T*&gt;,length_type,stride_type,length_type)">conv_full</a>(</span>
<a id="line390"></a><span class="lineno"> 390</span><span class="line">  std::<a href="" title="struct std::pair">pair</a>&lt;T*, T*&gt; coeff,</span>
<a id="line391"></a><span class="lineno"> 391</span><span class="line">  <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a>       coeff_size,	<span class="comment">// M</span></span>
<a id="line392"></a><span class="lineno"> 392</span><span class="line">  std::<a href="" title="struct std::pair">pair</a>&lt;T*, T*&gt; in,</span>
<a id="line393"></a><span class="lineno"> 393</span><span class="line">  <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a>       in_size,		<span class="comment">// N</span></span>
<a id="line394"></a><span class="lineno"> 394</span><span class="line">  <a href="../../../../Scopes/vsip.html#stride_type" title="typedef vsip::stride_type">stride_type</a>       in_stride,</span>
<a id="line395"></a><span class="lineno"> 395</span><span class="line">  std::<a href="" title="struct std::pair">pair</a>&lt;T*, T*&gt; out,</span>
<a id="line396"></a><span class="lineno"> 396</span><span class="line">  <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a>       out_size,		<span class="comment">// P</span></span>
<a id="line397"></a><span class="lineno"> 397</span><span class="line">  <a href="../../../../Scopes/vsip.html#stride_type" title="typedef vsip::stride_type">stride_type</a>       out_stride,</span>
<a id="line398"></a><span class="lineno"> 398</span><span class="line">  <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a>       decimation)</span>
<a id="line399"></a><span class="lineno"> 399</span><span class="line">{</span>
<a id="line400"></a><span class="lineno"> 400</span><span class="line">  <span class="keyword">typedef</span> <a href="../../../../Scopes/vsip/impl/Convolution_accum_trait.html#sum_type" title="typedef vsip::impl::Convolution_accum_trait::sum_type">typename Convolution_accum_trait&lt;complex&lt;T&gt; &gt;::sum_type</a> <a href="" title="typedef sum_type">sum_type</a>;</span>
<a id="line401"></a><span class="lineno"> 401</span><span class="line">  <span class="keyword">typedef</span> <a href="../../../../Scopes/vsip/impl/Storage.html" title="struct vsip::impl::Storage">Storage</a>&lt;<a href="../../../../Scopes/vsip/impl/Cmplx_split_fmt.html" title="struct vsip::impl::Cmplx_split_fmt">Cmplx_split_fmt</a>, complex&lt;T&gt; &gt; <a href="" title="typedef storage_type">storage_type</a>;</span>
<a id="line402"></a><span class="lineno"> 402</span>
<a id="line403"></a><span class="lineno"> 403</span><span class="line">  <span class="keyword">for</span> (<a href="../../../../Scopes/vsip.html#index_type" title="typedef vsip::index_type">index_type</a> <a href="" title="local variable `for::n">n</a>=<span class="literal">0</span>; <a href="" title="local variable `for::n">n</a>&lt;<a href="" title="parameter out_size">out_size</a>; ++<a href="" title="local variable `for::n">n</a>)</span>
<a id="line404"></a><span class="lineno"> 404</span><span class="line">  {</span>
<a id="line405"></a><span class="lineno"> 405</span><span class="line">    <a href="" title="typedef sum_type">sum_type</a> <a href="" title="local variable `for::sum">sum</a> = sum_type();</span>
<a id="line406"></a><span class="lineno"> 406</span><span class="line">      </span>
<a id="line407"></a><span class="lineno"> 407</span><span class="line">    <span class="keyword">for</span> (<a href="../../../../Scopes/vsip.html#index_type" title="typedef vsip::index_type">index_type</a> <a href="" title="local variable `for::`for::k">k</a>=<span class="literal">0</span>; <a href="" title="local variable `for::`for::k">k</a>&lt;<a href="" title="parameter coeff_size">coeff_size</a>; ++<a href="" title="local variable `for::`for::k">k</a>)</span>
<a id="line408"></a><span class="lineno"> 408</span><span class="line">    {</span>
<a id="line409"></a><span class="lineno"> 409</span><span class="line">      <span class="keyword">if</span> (<a href="" title="local variable `for::n">n</a>*<a href="" title="parameter decimation">decimation</a> &gt;= <a href="" title="local variable `for::`for::k">k</a> &amp;&amp; <a href="" title="local variable `for::n">n</a>*<a href="" title="parameter decimation">decimation</a>-<a href="" title="local variable `for::`for::k">k</a> &lt; <a href="" title="parameter in_size">in_size</a>)</span>
<a id="line410"></a><span class="lineno"> 410</span><span class="line">	<a href="" title="local variable `for::sum">sum</a> += <a href="../../../../Scopes/vsip/impl.html#get_lconst_Vector_LT_cBlock_R_cconst.Index_L_S_R_A_r" title="function template vsip::impl::get(const_Vector&lt;T,Block&gt;,const Index&lt;*&gt;&amp;)">storage_type::get</a>(<a href="" title="parameter coeff">coeff</a>, <a href="" title="local variable `for::`for::k">k</a>) *</span>
<a id="line411"></a><span class="lineno"> 411</span><span class="line">	       <a href="../../../../Scopes/vsip/impl.html#get_lconst_Vector_LT_cBlock_R_cconst.Index_L_S_R_A_r" title="function template vsip::impl::get(const_Vector&lt;T,Block&gt;,const Index&lt;*&gt;&amp;)">storage_type::get</a>(<a href="" title="parameter in">in</a>,   (<a href="" title="local variable `for::n">n</a>*<a href="" title="parameter decimation">decimation</a>-<a href="" title="local variable `for::`for::k">k</a>) * <a href="" title="parameter in_stride">in_stride</a>);</span>
<a id="line412"></a><span class="lineno"> 412</span><span class="line">    }</span>
<a id="line413"></a><span class="lineno"> 413</span><span class="line">    <a href="" title="function template vsip::impl::put(Block&amp;,const Index&lt;*&gt;&amp;,const Block::value_type&amp;)">storage_type::put</a>(<a href="" title="parameter out">out</a>, <a href="" title="local variable `for::n">n</a> * <a href="" title="parameter out_stride">out_stride</a>, <a href="" title="local variable `for::sum">sum</a>);</span>
<a id="line414"></a><span class="lineno"> 414</span><span class="line">  }</span>
<a id="line415"></a><span class="lineno"> 415</span><span class="line">}</span>
<a id="line416"></a><span class="lineno"> 416</span>
<a id="line417"></a><span class="lineno"> 417</span>
<a id="line418"></a><span class="lineno"> 418</span>
<a id="line419"></a><span class="lineno"> 419</span><span class="line"><span class="comment">/// Perform 1-D convolution with same region of support.</span></span>
<a id="line420"></a><span class="lineno"> 420</span>
<a id="line421"></a><span class="lineno"> 421</span><span class="line">template &lt;typename T&gt;</span>
<a id="line422"></a><span class="lineno"> 422</span><span class="line">inline <span class="keyword">void</span></span>
<a id="line423"></a><span class="lineno"> 423</span><span class="line"><a href="" title="function template vsip::impl::conv_same(std::pair&lt;T*,T*&gt;,length_type,std::pair&lt;T*,T*&gt;,length_type,stride_type,std::pair&lt;T*,T*&gt;,length_type,stride_type,length_type)">conv_same</a>(</span>
<a id="line424"></a><span class="lineno"> 424</span><span class="line">  std::<a href="" title="struct std::pair">pair</a>&lt;T*, T*&gt; coeff,</span>
<a id="line425"></a><span class="lineno"> 425</span><span class="line">  <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a>       coeff_size,	<span class="comment">// M</span></span>
<a id="line426"></a><span class="lineno"> 426</span><span class="line">  std::<a href="" title="struct std::pair">pair</a>&lt;T*, T*&gt; in,</span>
<a id="line427"></a><span class="lineno"> 427</span><span class="line">  <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a>       in_size,		<span class="comment">// N</span></span>
<a id="line428"></a><span class="lineno"> 428</span><span class="line">  <a href="../../../../Scopes/vsip.html#stride_type" title="typedef vsip::stride_type">stride_type</a>       in_stride,</span>
<a id="line429"></a><span class="lineno"> 429</span><span class="line">  std::<a href="" title="struct std::pair">pair</a>&lt;T*, T*&gt; out,</span>
<a id="line430"></a><span class="lineno"> 430</span><span class="line">  <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a>       out_size,		<span class="comment">// P</span></span>
<a id="line431"></a><span class="lineno"> 431</span><span class="line">  <a href="../../../../Scopes/vsip.html#stride_type" title="typedef vsip::stride_type">stride_type</a>       out_stride,</span>
<a id="line432"></a><span class="lineno"> 432</span><span class="line">  <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a>       decimation)</span>
<a id="line433"></a><span class="lineno"> 433</span><span class="line">{</span>
<a id="line434"></a><span class="lineno"> 434</span><span class="line">  <span class="keyword">typedef</span> <a href="../../../../Scopes/vsip/impl/Convolution_accum_trait.html#sum_type" title="typedef vsip::impl::Convolution_accum_trait::sum_type">typename Convolution_accum_trait&lt;complex&lt;T&gt; &gt;::sum_type</a> <a href="" title="typedef sum_type">sum_type</a>;</span>
<a id="line435"></a><span class="lineno"> 435</span><span class="line">  <span class="keyword">typedef</span> <a href="../../../../Scopes/vsip/impl/Storage.html" title="struct vsip::impl::Storage">Storage</a>&lt;<a href="../../../../Scopes/vsip/impl/Cmplx_split_fmt.html" title="struct vsip::impl::Cmplx_split_fmt">Cmplx_split_fmt</a>, complex&lt;T&gt; &gt; <a href="" title="typedef storage_type">storage_type</a>;</span>
<a id="line436"></a><span class="lineno"> 436</span>
<a id="line437"></a><span class="lineno"> 437</span><span class="line">  <span class="keyword">for</span> (<a href="../../../../Scopes/vsip.html#index_type" title="typedef vsip::index_type">index_type</a> <a href="" title="local variable `for::n">n</a>=<span class="literal">0</span>; <a href="" title="local variable `for::n">n</a>&lt;<a href="" title="parameter out_size">out_size</a>; ++<a href="" title="local variable `for::n">n</a>)</span>
<a id="line438"></a><span class="lineno"> 438</span><span class="line">  {</span>
<a id="line439"></a><span class="lineno"> 439</span><span class="line">    <a href="" title="typedef sum_type">sum_type</a> <a href="" title="local variable `for::sum">sum</a> = sum_type();</span>
<a id="line440"></a><span class="lineno"> 440</span><span class="line">      </span>
<a id="line441"></a><span class="lineno"> 441</span><span class="line">    <span class="keyword">for</span> (<a href="../../../../Scopes/vsip.html#index_type" title="typedef vsip::index_type">index_type</a> <a href="" title="local variable `for::`for::k">k</a>=<span class="literal">0</span>; <a href="" title="local variable `for::`for::k">k</a>&lt;<a href="" title="parameter coeff_size">coeff_size</a>; ++<a href="" title="local variable `for::`for::k">k</a>)</span>
<a id="line442"></a><span class="lineno"> 442</span><span class="line">    {</span>
<a id="line443"></a><span class="lineno"> 443</span><span class="line">      <span class="keyword">if</span> (<a href="" title="local variable `for::n">n</a>*<a href="" title="parameter decimation">decimation</a> + (<a href="" title="parameter coeff_size">coeff_size</a>/<span class="literal">2</span>)   &gt;= <a href="" title="local variable `for::`for::k">k</a> &amp;&amp;</span>
<a id="line444"></a><span class="lineno"> 444</span><span class="line">	  <a href="" title="local variable `for::n">n</a>*<a href="" title="parameter decimation">decimation</a> + (<a href="" title="parameter coeff_size">coeff_size</a>/<span class="literal">2</span>)-<a href="" title="local variable `for::`for::k">k</a> &lt;  <a href="" title="parameter in_size">in_size</a>)</span>
<a id="line445"></a><span class="lineno"> 445</span><span class="line">	<a href="" title="local variable `for::sum">sum</a> += <a href="../../../../Scopes/vsip/impl.html#get_lconst_Vector_LT_cBlock_R_cconst.Index_L_S_R_A_r" title="function template vsip::impl::get(const_Vector&lt;T,Block&gt;,const Index&lt;*&gt;&amp;)">storage_type::get</a>(<a href="" title="parameter coeff">coeff</a>, <a href="" title="local variable `for::`for::k">k</a>) *</span>
<a id="line446"></a><span class="lineno"> 446</span><span class="line">	       <a href="../../../../Scopes/vsip/impl.html#get_lconst_Vector_LT_cBlock_R_cconst.Index_L_S_R_A_r" title="function template vsip::impl::get(const_Vector&lt;T,Block&gt;,const Index&lt;*&gt;&amp;)">storage_type::get</a>(<a href="" title="parameter in">in</a>, (<a href="" title="local variable `for::n">n</a>*<a href="" title="parameter decimation">decimation</a>+(<a href="" title="parameter coeff_size">coeff_size</a>/<span class="literal">2</span>)-<a href="" title="local variable `for::`for::k">k</a>) * <a href="" title="parameter in_stride">in_stride</a>);</span>
<a id="line447"></a><span class="lineno"> 447</span><span class="line">    }</span>
<a id="line448"></a><span class="lineno"> 448</span><span class="line">    <a href="" title="function template vsip::impl::put(Block&amp;,const Index&lt;*&gt;&amp;,const Block::value_type&amp;)">storage_type::put</a>(<a href="" title="parameter out">out</a>, <a href="" title="local variable `for::n">n</a> * <a href="" title="parameter out_stride">out_stride</a>, <a href="" title="local variable `for::sum">sum</a>);</span>
<a id="line449"></a><span class="lineno"> 449</span><span class="line">  }</span>
<a id="line450"></a><span class="lineno"> 450</span><span class="line">}</span>
<a id="line451"></a><span class="lineno"> 451</span>
<a id="line452"></a><span class="lineno"> 452</span>
<a id="line453"></a><span class="lineno"> 453</span>
<a id="line454"></a><span class="lineno"> 454</span><span class="line"><span class="comment">/// Perform 1-D convolution with minimal region of support.</span></span>
<a id="line455"></a><span class="lineno"> 455</span>
<a id="line456"></a><span class="lineno"> 456</span><span class="line">template &lt;typename T&gt;</span>
<a id="line457"></a><span class="lineno"> 457</span><span class="line">inline <span class="keyword">void</span></span>
<a id="line458"></a><span class="lineno"> 458</span><span class="line"><a href="" title="function template vsip::impl::conv_min(std::pair&lt;T*,T*&gt;,length_type,std::pair&lt;T*,T*&gt;,length_type,stride_type,std::pair&lt;T*,T*&gt;,length_type,stride_type,length_type)">conv_min</a>(</span>
<a id="line459"></a><span class="lineno"> 459</span><span class="line">  std::<a href="" title="struct std::pair">pair</a>&lt;T*, T*&gt; coeff,</span>
<a id="line460"></a><span class="lineno"> 460</span><span class="line">  <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a>       coeff_size,	<span class="comment">// M</span></span>
<a id="line461"></a><span class="lineno"> 461</span><span class="line">  std::<a href="" title="struct std::pair">pair</a>&lt;T*, T*&gt; in,</span>
<a id="line462"></a><span class="lineno"> 462</span><span class="line">  <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a>       in_size,		<span class="comment">// N</span></span>
<a id="line463"></a><span class="lineno"> 463</span><span class="line">  <a href="../../../../Scopes/vsip.html#stride_type" title="typedef vsip::stride_type">stride_type</a>       in_stride,</span>
<a id="line464"></a><span class="lineno"> 464</span><span class="line">  std::<a href="" title="struct std::pair">pair</a>&lt;T*, T*&gt; out,</span>
<a id="line465"></a><span class="lineno"> 465</span><span class="line">  <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a>       out_size,		<span class="comment">// P</span></span>
<a id="line466"></a><span class="lineno"> 466</span><span class="line">  <a href="../../../../Scopes/vsip.html#stride_type" title="typedef vsip::stride_type">stride_type</a>       out_stride,</span>
<a id="line467"></a><span class="lineno"> 467</span><span class="line">  <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a>       decimation)</span>
<a id="line468"></a><span class="lineno"> 468</span><span class="line">{</span>
<a id="line469"></a><span class="lineno"> 469</span><span class="line">  <span class="keyword">typedef</span> <a href="../../../../Scopes/vsip/impl/Convolution_accum_trait.html#sum_type" title="typedef vsip::impl::Convolution_accum_trait::sum_type">typename Convolution_accum_trait&lt;complex&lt;T&gt; &gt;::sum_type</a> <a href="" title="typedef sum_type">sum_type</a>;</span>
<a id="line470"></a><span class="lineno"> 470</span><span class="line">  <span class="keyword">typedef</span> <a href="../../../../Scopes/vsip/impl/Storage.html" title="struct vsip::impl::Storage">Storage</a>&lt;<a href="../../../../Scopes/vsip/impl/Cmplx_split_fmt.html" title="struct vsip::impl::Cmplx_split_fmt">Cmplx_split_fmt</a>, complex&lt;T&gt; &gt; <a href="" title="typedef storage_type">storage_type</a>;</span>
<a id="line471"></a><span class="lineno"> 471</span>
<a id="line472"></a><span class="lineno"> 472</span><span class="line">#if VSIP_IMPL_CONV_CORRECT_MIN_SUPPORT_SIZE</span>
<a id="line473"></a><span class="lineno"> 473</span><span class="line">  <a href="" title="macro call">assert</a>((out_size-1)*decimation+(coeff_size-1) &lt; in_size);</span>
<a id="line474"></a><span class="lineno"> 474</span>
<a id="line475"></a><span class="lineno"> 475</span><span class="line">  <span class="keyword">for</span> (<a href="../../../../Scopes/vsip.html#index_type" title="typedef vsip::index_type">index_type</a> <a href="" title="local variable `for::n">n</a>=<span class="literal">0</span>; <a href="" title="local variable `for::n">n</a>&lt;<a href="" title="parameter out_size">out_size</a>; ++<a href="" title="local variable `for::n">n</a>)</span>
<a id="line476"></a><span class="lineno"> 476</span><span class="line">  {</span>
<a id="line477"></a><span class="lineno"> 477</span><span class="line">    <a href="" title="typedef sum_type">sum_type</a> <a href="" title="local variable `for::sum">sum</a> = sum_type();</span>
<a id="line478"></a><span class="lineno"> 478</span><span class="line">      </span>
<a id="line479"></a><span class="lineno"> 479</span><span class="line">    <a href="../../../../Scopes/vsip.html#index_type" title="typedef vsip::index_type">index_type</a> <a href="" title="local variable `for::offset">offset</a> = <a href="" title="local variable `for::n">n</a>*<a href="" title="parameter decimation">decimation</a>+(<a href="" title="parameter coeff_size">coeff_size</a>-<span class="literal">1</span>);</span>
<a id="line480"></a><span class="lineno"> 480</span><span class="line">    <span class="keyword">for</span> (<a href="../../../../Scopes/vsip.html#index_type" title="typedef vsip::index_type">index_type</a> <a href="" title="local variable `for::`for::k">k</a>=<span class="literal">0</span>; <a href="" title="local variable `for::`for::k">k</a>&lt;<a href="" title="parameter coeff_size">coeff_size</a>; ++<a href="" title="local variable `for::`for::k">k</a>)</span>
<a id="line481"></a><span class="lineno"> 481</span><span class="line">    {</span>
<a id="line482"></a><span class="lineno"> 482</span><span class="line">      <a href="" title="local variable `for::sum">sum</a> += <a href="../../../../Scopes/vsip/impl.html#get_lconst_Vector_LT_cBlock_R_cconst.Index_L_S_R_A_r" title="function template vsip::impl::get(const_Vector&lt;T,Block&gt;,const Index&lt;*&gt;&amp;)">storage_type::get</a>(<a href="" title="parameter coeff">coeff</a>, <a href="" title="local variable `for::`for::k">k</a>) *</span>
<a id="line483"></a><span class="lineno"> 483</span><span class="line">	     <a href="../../../../Scopes/vsip/impl.html#get_lconst_Vector_LT_cBlock_R_cconst.Index_L_S_R_A_r" title="function template vsip::impl::get(const_Vector&lt;T,Block&gt;,const Index&lt;*&gt;&amp;)">storage_type::get</a>(<a href="" title="parameter in">in</a>,    (<a href="" title="local variable `for::offset">offset</a>-<a href="" title="local variable `for::`for::k">k</a>) * <a href="" title="parameter in_stride">in_stride</a>);</span>
<a id="line484"></a><span class="lineno"> 484</span><span class="line">    }</span>
<a id="line485"></a><span class="lineno"> 485</span><span class="line">    <a href="" title="function template vsip::impl::put(Block&amp;,const Index&lt;*&gt;&amp;,const Block::value_type&amp;)">storage_type::put</a>(<a href="" title="parameter out">out</a>, <a href="" title="local variable `for::n">n</a> * <a href="" title="parameter out_stride">out_stride</a>, <a href="" title="local variable `for::sum">sum</a>);</span>
<a id="line486"></a><span class="lineno"> 486</span><span class="line">  }</span>
<a id="line487"></a><span class="lineno"> 487</span><span class="line">#else</span>
<a id="line488"></a><span class="lineno"> 488</span><span class="line">  for (index_type n=0; n&lt;out_size; ++n)</span>
<a id="line489"></a><span class="lineno"> 489</span><span class="line">  {</span>
<a id="line490"></a><span class="lineno"> 490</span><span class="line">    sum_type sum = sum_type();</span>
<a id="line491"></a><span class="lineno"> 491</span><span class="line">      </span>
<a id="line492"></a><span class="lineno"> 492</span><span class="line">    index_type offset = n*decimation+(coeff_size-1);</span>
<a id="line493"></a><span class="lineno"> 493</span><span class="line">    for (index_type k=0; k&lt;coeff_size; ++k)</span>
<a id="line494"></a><span class="lineno"> 494</span><span class="line">    {</span>
<a id="line495"></a><span class="lineno"> 495</span><span class="line">      if (offset-k &lt; in_size)</span>
<a id="line496"></a><span class="lineno"> 496</span><span class="line">        sum += storage_type::get(coeff, k) *</span>
<a id="line497"></a><span class="lineno"> 497</span><span class="line">	       storage_type::get(in,    (offset-k) * in_stride);</span>
<a id="line498"></a><span class="lineno"> 498</span><span class="line">    }</span>
<a id="line499"></a><span class="lineno"> 499</span><span class="line">    storage_type::put(out, n * out_stride, sum);</span>
<a id="line500"></a><span class="lineno"> 500</span><span class="line">  }</span>
<a id="line501"></a><span class="lineno"> 501</span><span class="line">#endif</span>
<a id="line502"></a><span class="lineno"> 502</span><span class="line">}</span>
<a id="line503"></a><span class="lineno"> 503</span>
<a id="line504"></a><span class="lineno"> 504</span>
<a id="line505"></a><span class="lineno"> 505</span>
<a id="line506"></a><span class="lineno"> 506</span><span class="line"><span class="comment">/***********************************************************************</span></span>
<a id="line507"></a><span class="lineno"> 507</span><span class="line"><span class="comment">  2-D Convolutions (interleaved)</span></span>
<a id="line508"></a><span class="lineno"> 508</span><span class="line"><span class="comment">***********************************************************************/</span></span>
<a id="line509"></a><span class="lineno"> 509</span>
<a id="line510"></a><span class="lineno"> 510</span><span class="line"><span class="comment">/// Perform 2-D convolution with full region of support.</span></span>
<a id="line511"></a><span class="lineno"> 511</span>
<a id="line512"></a><span class="lineno"> 512</span><span class="line">template &lt;typename T&gt;</span>
<a id="line513"></a><span class="lineno"> 513</span><span class="line">inline <span class="keyword">void</span></span>
<a id="line514"></a><span class="lineno"> 514</span><span class="line"><a href="../../../../Scopes/vsip/impl.html#conv_full_lT_S_clength_type_clength_type_cstride_type_cstride_type_cT_S_clength_type_clength_type_cstride_type_cstride_type_cT_S_clength_type_clength_type_cstride_type_cstride_type_clength_type_r" title="function template vsip::impl::conv_full(T*,length_type,length_type,stride_type,stride_type,T*,length_type,length_type,stride_type,stride_type,T*,length_type,length_type,stride_type,stride_type,length_type)">conv_full</a>(</span>
<a id="line515"></a><span class="lineno"> 515</span><span class="line">  T*          coeff,</span>
<a id="line516"></a><span class="lineno"> 516</span><span class="line">  <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a> coeff_rows,	<span class="comment">// Mr</span></span>
<a id="line517"></a><span class="lineno"> 517</span><span class="line">  <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a> coeff_cols,	<span class="comment">// Mc</span></span>
<a id="line518"></a><span class="lineno"> 518</span><span class="line">  <a href="../../../../Scopes/vsip.html#stride_type" title="typedef vsip::stride_type">stride_type</a> coeff_row_stride,</span>
<a id="line519"></a><span class="lineno"> 519</span><span class="line">  <a href="../../../../Scopes/vsip.html#stride_type" title="typedef vsip::stride_type">stride_type</a> coeff_col_stride,</span>
<a id="line520"></a><span class="lineno"> 520</span>
<a id="line521"></a><span class="lineno"> 521</span><span class="line">  T*          in,</span>
<a id="line522"></a><span class="lineno"> 522</span><span class="line">  <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a> in_rows,		<span class="comment">// Nr</span></span>
<a id="line523"></a><span class="lineno"> 523</span><span class="line">  <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a> in_cols,		<span class="comment">// Nc</span></span>
<a id="line524"></a><span class="lineno"> 524</span><span class="line">  <a href="../../../../Scopes/vsip.html#stride_type" title="typedef vsip::stride_type">stride_type</a> in_row_stride,</span>
<a id="line525"></a><span class="lineno"> 525</span><span class="line">  <a href="../../../../Scopes/vsip.html#stride_type" title="typedef vsip::stride_type">stride_type</a> in_col_stride,</span>
<a id="line526"></a><span class="lineno"> 526</span>
<a id="line527"></a><span class="lineno"> 527</span><span class="line">  T*          out,</span>
<a id="line528"></a><span class="lineno"> 528</span><span class="line">  <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a> out_rows,		<span class="comment">// Pr</span></span>
<a id="line529"></a><span class="lineno"> 529</span><span class="line">  <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a> out_cols,		<span class="comment">// Pc</span></span>
<a id="line530"></a><span class="lineno"> 530</span><span class="line">  <a href="../../../../Scopes/vsip.html#stride_type" title="typedef vsip::stride_type">stride_type</a> out_row_stride,</span>
<a id="line531"></a><span class="lineno"> 531</span><span class="line">  <a href="../../../../Scopes/vsip.html#stride_type" title="typedef vsip::stride_type">stride_type</a> out_col_stride,</span>
<a id="line532"></a><span class="lineno"> 532</span>
<a id="line533"></a><span class="lineno"> 533</span><span class="line">  <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a> decimation)</span>
<a id="line534"></a><span class="lineno"> 534</span><span class="line">{</span>
<a id="line535"></a><span class="lineno"> 535</span><span class="line">  <span class="keyword">typedef</span> <a href="../../../../Scopes/vsip/impl/Convolution_accum_trait.html#sum_type" title="typedef vsip::impl::Convolution_accum_trait::sum_type">typename Convolution_accum_trait&lt;T&gt;::sum_type</a> <a href="" title="typedef sum_type">sum_type</a>;</span>
<a id="line536"></a><span class="lineno"> 536</span>
<a id="line537"></a><span class="lineno"> 537</span><span class="line">  <span class="keyword">for</span> (<a href="../../../../Scopes/vsip.html#index_type" title="typedef vsip::index_type">index_type</a> <a href="" title="local variable `for::r">r</a>=<span class="literal">0</span>; <a href="" title="local variable `for::r">r</a>&lt;<a href="" title="parameter out_rows">out_rows</a>; ++<a href="" title="local variable `for::r">r</a>)</span>
<a id="line538"></a><span class="lineno"> 538</span><span class="line">  {</span>
<a id="line539"></a><span class="lineno"> 539</span><span class="line">    <span class="keyword">for</span> (<a href="../../../../Scopes/vsip.html#index_type" title="typedef vsip::index_type">index_type</a> <a href="" title="local variable `for::`for::c">c</a>=<span class="literal">0</span>; <a href="" title="local variable `for::`for::c">c</a>&lt;<a href="" title="parameter out_cols">out_cols</a>; ++<a href="" title="local variable `for::`for::c">c</a>)</span>
<a id="line540"></a><span class="lineno"> 540</span><span class="line">    {</span>
<a id="line541"></a><span class="lineno"> 541</span><span class="line">      <a href="" title="typedef sum_type">sum_type</a> <a href="" title="local variable `for::`for::sum">sum</a> = sum_type();</span>
<a id="line542"></a><span class="lineno"> 542</span>
<a id="line543"></a><span class="lineno"> 543</span><span class="line">      <span class="keyword">for</span> (<a href="../../../../Scopes/vsip.html#index_type" title="typedef vsip::index_type">index_type</a> <a href="" title="local variable `for::`for::`for::rr">rr</a>=<span class="literal">0</span>; <a href="" title="local variable `for::`for::`for::rr">rr</a>&lt;<a href="" title="parameter coeff_rows">coeff_rows</a>; ++<a href="" title="local variable `for::`for::`for::rr">rr</a>)</span>
<a id="line544"></a><span class="lineno"> 544</span><span class="line">      {</span>
<a id="line545"></a><span class="lineno"> 545</span><span class="line">	<span class="keyword">for</span> (<a href="../../../../Scopes/vsip.html#index_type" title="typedef vsip::index_type">index_type</a> <a href="" title="local variable `for::`for::`for::`for::cc">cc</a>=<span class="literal">0</span>; <a href="" title="local variable `for::`for::`for::`for::cc">cc</a>&lt;<a href="" title="parameter coeff_cols">coeff_cols</a>; ++<a href="" title="local variable `for::`for::`for::`for::cc">cc</a>)</span>
<a id="line546"></a><span class="lineno"> 546</span><span class="line">	{</span>
<a id="line547"></a><span class="lineno"> 547</span><span class="line">	  <span class="keyword">if</span> (<a href="" title="local variable `for::r">r</a>*<a href="" title="parameter decimation">decimation</a> &gt;= <a href="" title="local variable `for::`for::`for::rr">rr</a> &amp;&amp; <a href="" title="local variable `for::r">r</a>*<a href="" title="parameter decimation">decimation</a>-<a href="" title="local variable `for::`for::`for::rr">rr</a> &lt; <a href="" title="parameter in_rows">in_rows</a> &amp;&amp;</span>
<a id="line548"></a><span class="lineno"> 548</span><span class="line">	      <a href="" title="local variable `for::`for::c">c</a>*<a href="" title="parameter decimation">decimation</a> &gt;= <a href="" title="local variable `for::`for::`for::`for::cc">cc</a> &amp;&amp; <a href="" title="local variable `for::`for::c">c</a>*<a href="" title="parameter decimation">decimation</a>-<a href="" title="local variable `for::`for::`for::`for::cc">cc</a> &lt; <a href="" title="parameter in_cols">in_cols</a>)</span>
<a id="line549"></a><span class="lineno"> 549</span><span class="line">	  {</span>
<a id="line550"></a><span class="lineno"> 550</span><span class="line">	    <a href="" title="local variable `for::`for::sum">sum</a> += <a href="" title="parameter coeff">coeff</a>[<a href="" title="local variable `for::`for::`for::rr">rr</a>*<a href="" title="parameter coeff_row_stride">coeff_row_stride</a> + <a href="" title="local variable `for::`for::`for::`for::cc">cc</a>*<a href="" title="parameter coeff_col_stride">coeff_col_stride</a>] *</span>
<a id="line551"></a><span class="lineno"> 551</span><span class="line">                   <a href="" title="parameter in">in</a>[(<a href="" title="local variable `for::r">r</a>*<a href="" title="parameter decimation">decimation</a>-<a href="" title="local variable `for::`for::`for::rr">rr</a>) * <a href="" title="parameter in_row_stride">in_row_stride</a> +</span>
<a id="line552"></a><span class="lineno"> 552</span><span class="line">		      (<a href="" title="local variable `for::`for::c">c</a>*<a href="" title="parameter decimation">decimation</a>-<a href="" title="local variable `for::`for::`for::`for::cc">cc</a>) * <a href="" title="parameter in_col_stride">in_col_stride</a>];</span>
<a id="line553"></a><span class="lineno"> 553</span><span class="line">	  }</span>
<a id="line554"></a><span class="lineno"> 554</span><span class="line">	}</span>
<a id="line555"></a><span class="lineno"> 555</span><span class="line">      }</span>
<a id="line556"></a><span class="lineno"> 556</span><span class="line">      <a href="" title="parameter out">out</a>[<a href="" title="local variable `for::r">r</a> * <a href="" title="parameter out_row_stride">out_row_stride</a> + <a href="" title="local variable `for::`for::c">c</a> * <a href="" title="parameter out_col_stride">out_col_stride</a>] = <a href="" title="local variable `for::`for::sum">sum</a>;</span>
<a id="line557"></a><span class="lineno"> 557</span><span class="line">    }</span>
<a id="line558"></a><span class="lineno"> 558</span><span class="line">  }</span>
<a id="line559"></a><span class="lineno"> 559</span><span class="line">}</span>
<a id="line560"></a><span class="lineno"> 560</span>
<a id="line561"></a><span class="lineno"> 561</span>
<a id="line562"></a><span class="lineno"> 562</span>
<a id="line563"></a><span class="lineno"> 563</span><span class="line"><span class="comment">/// Perform 2-D convolution with same region of support.</span></span>
<a id="line564"></a><span class="lineno"> 564</span>
<a id="line565"></a><span class="lineno"> 565</span><span class="line">template &lt;typename T&gt;</span>
<a id="line566"></a><span class="lineno"> 566</span><span class="line">inline <span class="keyword">void</span></span>
<a id="line567"></a><span class="lineno"> 567</span><span class="line"><a href="../../../../Scopes/vsip/impl.html#conv_same_lT_S_clength_type_clength_type_cstride_type_cstride_type_cT_S_clength_type_clength_type_cstride_type_cstride_type_cT_S_clength_type_clength_type_cstride_type_cstride_type_clength_type_r" title="function template vsip::impl::conv_same(T*,length_type,length_type,stride_type,stride_type,T*,length_type,length_type,stride_type,stride_type,T*,length_type,length_type,stride_type,stride_type,length_type)">conv_same</a>(</span>
<a id="line568"></a><span class="lineno"> 568</span><span class="line">  T*          coeff,</span>
<a id="line569"></a><span class="lineno"> 569</span><span class="line">  <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a> coeff_rows,	<span class="comment">// Mr</span></span>
<a id="line570"></a><span class="lineno"> 570</span><span class="line">  <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a> coeff_cols,	<span class="comment">// Mc</span></span>
<a id="line571"></a><span class="lineno"> 571</span><span class="line">  <a href="../../../../Scopes/vsip.html#stride_type" title="typedef vsip::stride_type">stride_type</a> coeff_row_stride,</span>
<a id="line572"></a><span class="lineno"> 572</span><span class="line">  <a href="../../../../Scopes/vsip.html#stride_type" title="typedef vsip::stride_type">stride_type</a> coeff_col_stride,</span>
<a id="line573"></a><span class="lineno"> 573</span>
<a id="line574"></a><span class="lineno"> 574</span><span class="line">  T*          in,</span>
<a id="line575"></a><span class="lineno"> 575</span><span class="line">  <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a> in_rows,		<span class="comment">// Nr</span></span>
<a id="line576"></a><span class="lineno"> 576</span><span class="line">  <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a> in_cols,		<span class="comment">// Nc</span></span>
<a id="line577"></a><span class="lineno"> 577</span><span class="line">  <a href="../../../../Scopes/vsip.html#stride_type" title="typedef vsip::stride_type">stride_type</a> in_row_stride,</span>
<a id="line578"></a><span class="lineno"> 578</span><span class="line">  <a href="../../../../Scopes/vsip.html#stride_type" title="typedef vsip::stride_type">stride_type</a> in_col_stride,</span>
<a id="line579"></a><span class="lineno"> 579</span>
<a id="line580"></a><span class="lineno"> 580</span><span class="line">  T*          out,</span>
<a id="line581"></a><span class="lineno"> 581</span><span class="line">  <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a> out_rows,		<span class="comment">// Pr</span></span>
<a id="line582"></a><span class="lineno"> 582</span><span class="line">  <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a> out_cols,		<span class="comment">// Pc</span></span>
<a id="line583"></a><span class="lineno"> 583</span><span class="line">  <a href="../../../../Scopes/vsip.html#stride_type" title="typedef vsip::stride_type">stride_type</a> out_row_stride,</span>
<a id="line584"></a><span class="lineno"> 584</span><span class="line">  <a href="../../../../Scopes/vsip.html#stride_type" title="typedef vsip::stride_type">stride_type</a> out_col_stride,</span>
<a id="line585"></a><span class="lineno"> 585</span>
<a id="line586"></a><span class="lineno"> 586</span><span class="line">  <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a> decimation)</span>
<a id="line587"></a><span class="lineno"> 587</span><span class="line">{</span>
<a id="line588"></a><span class="lineno"> 588</span><span class="line">  <span class="keyword">typedef</span> <a href="../../../../Scopes/vsip/impl/Convolution_accum_trait.html#sum_type" title="typedef vsip::impl::Convolution_accum_trait::sum_type">typename Convolution_accum_trait&lt;T&gt;::sum_type</a> <a href="" title="typedef sum_type">sum_type</a>;</span>
<a id="line589"></a><span class="lineno"> 589</span>
<a id="line590"></a><span class="lineno"> 590</span><span class="line">  <span class="keyword">for</span> (<a href="../../../../Scopes/vsip.html#index_type" title="typedef vsip::index_type">index_type</a> <a href="" title="local variable `for::r">r</a>=<span class="literal">0</span>; <a href="" title="local variable `for::r">r</a>&lt;<a href="" title="parameter out_rows">out_rows</a>; ++<a href="" title="local variable `for::r">r</a>)</span>
<a id="line591"></a><span class="lineno"> 591</span><span class="line">  {</span>
<a id="line592"></a><span class="lineno"> 592</span><span class="line">    <a href="../../../../Scopes/vsip.html#index_type" title="typedef vsip::index_type">index_type</a> <a href="" title="local variable `for::ir">ir</a> = <a href="" title="local variable `for::r">r</a>*<a href="" title="parameter decimation">decimation</a> + (<a href="" title="parameter coeff_rows">coeff_rows</a>/<span class="literal">2</span>);</span>
<a id="line593"></a><span class="lineno"> 593</span>
<a id="line594"></a><span class="lineno"> 594</span><span class="line">    <span class="keyword">for</span> (<a href="../../../../Scopes/vsip.html#index_type" title="typedef vsip::index_type">index_type</a> <a href="" title="local variable `for::`for::c">c</a>=<span class="literal">0</span>; <a href="" title="local variable `for::`for::c">c</a>&lt;<a href="" title="parameter out_cols">out_cols</a>; ++<a href="" title="local variable `for::`for::c">c</a>)</span>
<a id="line595"></a><span class="lineno"> 595</span><span class="line">    {</span>
<a id="line596"></a><span class="lineno"> 596</span><span class="line">      <a href="../../../../Scopes/vsip.html#index_type" title="typedef vsip::index_type">index_type</a> <a href="" title="local variable `for::`for::ic">ic</a> = <a href="" title="local variable `for::`for::c">c</a>*<a href="" title="parameter decimation">decimation</a> + (<a href="" title="parameter coeff_cols">coeff_cols</a>/<span class="literal">2</span>);</span>
<a id="line597"></a><span class="lineno"> 597</span>
<a id="line598"></a><span class="lineno"> 598</span><span class="line">      <a href="" title="typedef sum_type">sum_type</a> <a href="" title="local variable `for::`for::sum">sum</a> = sum_type();</span>
<a id="line599"></a><span class="lineno"> 599</span>
<a id="line600"></a><span class="lineno"> 600</span><span class="line">      <span class="keyword">for</span> (<a href="../../../../Scopes/vsip.html#index_type" title="typedef vsip::index_type">index_type</a> <a href="" title="local variable `for::`for::`for::rr">rr</a>=<span class="literal">0</span>; <a href="" title="local variable `for::`for::`for::rr">rr</a>&lt;<a href="" title="parameter coeff_rows">coeff_rows</a>; ++<a href="" title="local variable `for::`for::`for::rr">rr</a>)</span>
<a id="line601"></a><span class="lineno"> 601</span><span class="line">      {</span>
<a id="line602"></a><span class="lineno"> 602</span><span class="line">	<span class="keyword">for</span> (<a href="../../../../Scopes/vsip.html#index_type" title="typedef vsip::index_type">index_type</a> <a href="" title="local variable `for::`for::`for::`for::cc">cc</a>=<span class="literal">0</span>; <a href="" title="local variable `for::`for::`for::`for::cc">cc</a>&lt;<a href="" title="parameter coeff_cols">coeff_cols</a>; ++<a href="" title="local variable `for::`for::`for::`for::cc">cc</a>)</span>
<a id="line603"></a><span class="lineno"> 603</span><span class="line">	{</span>
<a id="line604"></a><span class="lineno"> 604</span>
<a id="line605"></a><span class="lineno"> 605</span><span class="line">	  <span class="keyword">if</span> (<a href="" title="local variable `for::ir">ir</a> &gt;= <a href="" title="local variable `for::`for::`for::rr">rr</a> &amp;&amp; <a href="" title="local variable `for::ir">ir</a>-<a href="" title="local variable `for::`for::`for::rr">rr</a> &lt; <a href="" title="parameter in_rows">in_rows</a> &amp;&amp; <a href="" title="local variable `for::`for::ic">ic</a> &gt;= <a href="" title="local variable `for::`for::`for::`for::cc">cc</a> &amp;&amp; <a href="" title="local variable `for::`for::ic">ic</a>-<a href="" title="local variable `for::`for::`for::`for::cc">cc</a> &lt; <a href="" title="parameter in_cols">in_cols</a>) </span>
<a id="line606"></a><span class="lineno"> 606</span><span class="line">	  {</span>
<a id="line607"></a><span class="lineno"> 607</span><span class="line">	    <a href="" title="local variable `for::`for::sum">sum</a> += <a href="" title="parameter coeff">coeff</a>[<a href="" title="local variable `for::`for::`for::rr">rr</a>*<a href="" title="parameter coeff_row_stride">coeff_row_stride</a> + <a href="" title="local variable `for::`for::`for::`for::cc">cc</a>*<a href="" title="parameter coeff_col_stride">coeff_col_stride</a>] *</span>
<a id="line608"></a><span class="lineno"> 608</span><span class="line">	           <a href="" title="parameter in">in</a>[(<a href="" title="local variable `for::ir">ir</a>-<a href="" title="local variable `for::`for::`for::rr">rr</a>) * <a href="" title="parameter in_row_stride">in_row_stride</a> + (<a href="" title="local variable `for::`for::ic">ic</a>-<a href="" title="local variable `for::`for::`for::`for::cc">cc</a>) * <a href="" title="parameter in_col_stride">in_col_stride</a>];</span>
<a id="line609"></a><span class="lineno"> 609</span><span class="line">	  }</span>
<a id="line610"></a><span class="lineno"> 610</span><span class="line">	}</span>
<a id="line611"></a><span class="lineno"> 611</span><span class="line">      }</span>
<a id="line612"></a><span class="lineno"> 612</span><span class="line">      <a href="" title="parameter out">out</a>[<a href="" title="local variable `for::r">r</a> * <a href="" title="parameter out_row_stride">out_row_stride</a> + <a href="" title="local variable `for::`for::c">c</a> * <a href="" title="parameter out_col_stride">out_col_stride</a>] = <a href="" title="local variable `for::`for::sum">sum</a>;</span>
<a id="line613"></a><span class="lineno"> 613</span><span class="line">    }</span>
<a id="line614"></a><span class="lineno"> 614</span><span class="line">  }</span>
<a id="line615"></a><span class="lineno"> 615</span><span class="line">}</span>
<a id="line616"></a><span class="lineno"> 616</span>
<a id="line617"></a><span class="lineno"> 617</span>
<a id="line618"></a><span class="lineno"> 618</span>
<a id="line619"></a><span class="lineno"> 619</span><span class="line"><span class="comment">/// Perform 2-D convolution with minimal region of support.</span></span>
<a id="line620"></a><span class="lineno"> 620</span>
<a id="line621"></a><span class="lineno"> 621</span><span class="line">template &lt;typename T&gt;</span>
<a id="line622"></a><span class="lineno"> 622</span><span class="line">inline <span class="keyword">void</span></span>
<a id="line623"></a><span class="lineno"> 623</span><span class="line"><a href="../../../../Scopes/vsip/impl.html#conv_min_lT_S_clength_type_clength_type_cstride_type_cstride_type_cT_S_clength_type_clength_type_cstride_type_cstride_type_cT_S_clength_type_clength_type_cstride_type_cstride_type_clength_type_r" title="function template vsip::impl::conv_min(T*,length_type,length_type,stride_type,stride_type,T*,length_type,length_type,stride_type,stride_type,T*,length_type,length_type,stride_type,stride_type,length_type)">conv_min</a>(</span>
<a id="line624"></a><span class="lineno"> 624</span><span class="line">  T*          coeff,</span>
<a id="line625"></a><span class="lineno"> 625</span><span class="line">  <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a> coeff_rows,	<span class="comment">// Mr</span></span>
<a id="line626"></a><span class="lineno"> 626</span><span class="line">  <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a> coeff_cols,	<span class="comment">// Mc</span></span>
<a id="line627"></a><span class="lineno"> 627</span><span class="line">  <a href="../../../../Scopes/vsip.html#stride_type" title="typedef vsip::stride_type">stride_type</a> coeff_row_stride,</span>
<a id="line628"></a><span class="lineno"> 628</span><span class="line">  <a href="../../../../Scopes/vsip.html#stride_type" title="typedef vsip::stride_type">stride_type</a> coeff_col_stride,</span>
<a id="line629"></a><span class="lineno"> 629</span>
<a id="line630"></a><span class="lineno"> 630</span><span class="line">  T*          in,</span>
<a id="line631"></a><span class="lineno"> 631</span><span class="line">  <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a> in_rows,		<span class="comment">// Nr</span></span>
<a id="line632"></a><span class="lineno"> 632</span><span class="line">  <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a> in_cols,		<span class="comment">// Nc</span></span>
<a id="line633"></a><span class="lineno"> 633</span><span class="line">  <a href="../../../../Scopes/vsip.html#stride_type" title="typedef vsip::stride_type">stride_type</a> in_row_stride,</span>
<a id="line634"></a><span class="lineno"> 634</span><span class="line">  <a href="../../../../Scopes/vsip.html#stride_type" title="typedef vsip::stride_type">stride_type</a> in_col_stride,</span>
<a id="line635"></a><span class="lineno"> 635</span>
<a id="line636"></a><span class="lineno"> 636</span><span class="line">  T*          out,</span>
<a id="line637"></a><span class="lineno"> 637</span><span class="line">  <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a> out_rows,		<span class="comment">// Pr</span></span>
<a id="line638"></a><span class="lineno"> 638</span><span class="line">  <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a> out_cols,		<span class="comment">// Pc</span></span>
<a id="line639"></a><span class="lineno"> 639</span><span class="line">  <a href="../../../../Scopes/vsip.html#stride_type" title="typedef vsip::stride_type">stride_type</a> out_row_stride,</span>
<a id="line640"></a><span class="lineno"> 640</span><span class="line">  <a href="../../../../Scopes/vsip.html#stride_type" title="typedef vsip::stride_type">stride_type</a> out_col_stride,</span>
<a id="line641"></a><span class="lineno"> 641</span>
<a id="line642"></a><span class="lineno"> 642</span><span class="line">  <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a> decimation)</span>
<a id="line643"></a><span class="lineno"> 643</span><span class="line">{</span>
<a id="line644"></a><span class="lineno"> 644</span><span class="line">  <span class="keyword">typedef</span> <a href="../../../../Scopes/vsip/impl/Convolution_accum_trait.html#sum_type" title="typedef vsip::impl::Convolution_accum_trait::sum_type">typename Convolution_accum_trait&lt;T&gt;::sum_type</a> <a href="" title="typedef sum_type">sum_type</a>;</span>
<a id="line645"></a><span class="lineno"> 645</span>
<a id="line646"></a><span class="lineno"> 646</span><span class="line">#if VSIP_IMPL_CONV_CORRECT_MIN_SUPPORT_SIZE</span>
<a id="line647"></a><span class="lineno"> 647</span><span class="line">  (<span class="keyword">void</span>)<a href="" title="parameter in_rows">in_rows</a>;</span>
<a id="line648"></a><span class="lineno"> 648</span><span class="line">  (<span class="keyword">void</span>)<a href="" title="parameter in_cols">in_cols</a>;</span>
<a id="line649"></a><span class="lineno"> 649</span>
<a id="line650"></a><span class="lineno"> 650</span><span class="line">  <span class="keyword">for</span> (<a href="../../../../Scopes/vsip.html#index_type" title="typedef vsip::index_type">index_type</a> <a href="" title="local variable `for::r">r</a>=<span class="literal">0</span>; <a href="" title="local variable `for::r">r</a>&lt;<a href="" title="parameter out_rows">out_rows</a>; ++<a href="" title="local variable `for::r">r</a>)</span>
<a id="line651"></a><span class="lineno"> 651</span><span class="line">  {</span>
<a id="line652"></a><span class="lineno"> 652</span><span class="line">    <a href="../../../../Scopes/vsip.html#index_type" title="typedef vsip::index_type">index_type</a> <a href="" title="local variable `for::ir">ir</a> = <a href="" title="local variable `for::r">r</a>*<a href="" title="parameter decimation">decimation</a> + (<a href="" title="parameter coeff_rows">coeff_rows</a>-<span class="literal">1</span>);</span>
<a id="line653"></a><span class="lineno"> 653</span><span class="line">    <span class="keyword">for</span> (<a href="../../../../Scopes/vsip.html#index_type" title="typedef vsip::index_type">index_type</a> <a href="" title="local variable `for::`for::c">c</a>=<span class="literal">0</span>; <a href="" title="local variable `for::`for::c">c</a>&lt;<a href="" title="parameter out_cols">out_cols</a>; ++<a href="" title="local variable `for::`for::c">c</a>)</span>
<a id="line654"></a><span class="lineno"> 654</span><span class="line">    {</span>
<a id="line655"></a><span class="lineno"> 655</span><span class="line">      <a href="../../../../Scopes/vsip.html#index_type" title="typedef vsip::index_type">index_type</a> <a href="" title="local variable `for::`for::ic">ic</a> = <a href="" title="local variable `for::`for::c">c</a>*<a href="" title="parameter decimation">decimation</a> + (<a href="" title="parameter coeff_cols">coeff_cols</a>-<span class="literal">1</span>);</span>
<a id="line656"></a><span class="lineno"> 656</span>
<a id="line657"></a><span class="lineno"> 657</span><span class="line">      <a href="" title="typedef sum_type">sum_type</a> <a href="" title="local variable `for::`for::sum">sum</a> = sum_type();</span>
<a id="line658"></a><span class="lineno"> 658</span>
<a id="line659"></a><span class="lineno"> 659</span><span class="line">      <span class="keyword">for</span> (<a href="../../../../Scopes/vsip.html#index_type" title="typedef vsip::index_type">index_type</a> <a href="" title="local variable `for::`for::`for::rr">rr</a>=<span class="literal">0</span>; <a href="" title="local variable `for::`for::`for::rr">rr</a>&lt;<a href="" title="parameter coeff_rows">coeff_rows</a>; ++<a href="" title="local variable `for::`for::`for::rr">rr</a>)</span>
<a id="line660"></a><span class="lineno"> 660</span><span class="line">      {</span>
<a id="line661"></a><span class="lineno"> 661</span><span class="line">	<span class="keyword">for</span> (<a href="../../../../Scopes/vsip.html#index_type" title="typedef vsip::index_type">index_type</a> <a href="" title="local variable `for::`for::`for::`for::cc">cc</a>=<span class="literal">0</span>; <a href="" title="local variable `for::`for::`for::`for::cc">cc</a>&lt;<a href="" title="parameter coeff_cols">coeff_cols</a>; ++<a href="" title="local variable `for::`for::`for::`for::cc">cc</a>)</span>
<a id="line662"></a><span class="lineno"> 662</span><span class="line">	{</span>
<a id="line663"></a><span class="lineno"> 663</span><span class="line">	  <a href="" title="local variable `for::`for::sum">sum</a> += <a href="" title="parameter coeff">coeff</a>[<a href="" title="local variable `for::`for::`for::rr">rr</a>*<a href="" title="parameter coeff_row_stride">coeff_row_stride</a> + <a href="" title="local variable `for::`for::`for::`for::cc">cc</a>*<a href="" title="parameter coeff_col_stride">coeff_col_stride</a>] *</span>
<a id="line664"></a><span class="lineno"> 664</span><span class="line">	         <a href="" title="parameter in">in</a>[(<a href="" title="local variable `for::ir">ir</a>-<a href="" title="local variable `for::`for::`for::rr">rr</a>) * <a href="" title="parameter in_row_stride">in_row_stride</a> + (<a href="" title="local variable `for::`for::ic">ic</a>-<a href="" title="local variable `for::`for::`for::`for::cc">cc</a>) * <a href="" title="parameter in_col_stride">in_col_stride</a>];</span>
<a id="line665"></a><span class="lineno"> 665</span><span class="line">	}</span>
<a id="line666"></a><span class="lineno"> 666</span><span class="line">      }</span>
<a id="line667"></a><span class="lineno"> 667</span><span class="line">      <a href="" title="parameter out">out</a>[<a href="" title="local variable `for::r">r</a> * <a href="" title="parameter out_row_stride">out_row_stride</a> + <a href="" title="local variable `for::`for::c">c</a> * <a href="" title="parameter out_col_stride">out_col_stride</a>] = <a href="" title="local variable `for::`for::sum">sum</a>;</span>
<a id="line668"></a><span class="lineno"> 668</span><span class="line">    }</span>
<a id="line669"></a><span class="lineno"> 669</span><span class="line">  }</span>
<a id="line670"></a><span class="lineno"> 670</span><span class="line">#else</span>
<a id="line671"></a><span class="lineno"> 671</span><span class="line">  for (index_type r=0; r&lt;out_rows; ++r)</span>
<a id="line672"></a><span class="lineno"> 672</span><span class="line">  {</span>
<a id="line673"></a><span class="lineno"> 673</span><span class="line">    index_type ir = r*decimation + (coeff_rows-1);</span>
<a id="line674"></a><span class="lineno"> 674</span><span class="line">    for (index_type c=0; c&lt;out_cols; ++c)</span>
<a id="line675"></a><span class="lineno"> 675</span><span class="line">    {</span>
<a id="line676"></a><span class="lineno"> 676</span><span class="line">      index_type ic = c*decimation + (coeff_cols-1);</span>
<a id="line677"></a><span class="lineno"> 677</span>
<a id="line678"></a><span class="lineno"> 678</span><span class="line">      sum_type sum = sum_type();</span>
<a id="line679"></a><span class="lineno"> 679</span>
<a id="line680"></a><span class="lineno"> 680</span><span class="line">      for (index_type rr=0; rr&lt;coeff_rows; ++rr)</span>
<a id="line681"></a><span class="lineno"> 681</span><span class="line">      {</span>
<a id="line682"></a><span class="lineno"> 682</span><span class="line">	for (index_type cc=0; cc&lt;coeff_cols; ++cc)</span>
<a id="line683"></a><span class="lineno"> 683</span><span class="line">	{</span>
<a id="line684"></a><span class="lineno"> 684</span><span class="line">	  if (ir-rr &lt; in_rows &amp;&amp; ic-cc &lt; in_cols)</span>
<a id="line685"></a><span class="lineno"> 685</span><span class="line">	  {</span>
<a id="line686"></a><span class="lineno"> 686</span><span class="line">	    sum += coeff[rr*coeff_row_stride + cc*coeff_col_stride] *</span>
<a id="line687"></a><span class="lineno"> 687</span><span class="line">	           in[(ir-rr) * in_row_stride + (ic-cc) * in_col_stride];</span>
<a id="line688"></a><span class="lineno"> 688</span><span class="line">	  }</span>
<a id="line689"></a><span class="lineno"> 689</span><span class="line">	}</span>
<a id="line690"></a><span class="lineno"> 690</span><span class="line">      }</span>
<a id="line691"></a><span class="lineno"> 691</span><span class="line">      out[r * out_row_stride + c * out_col_stride] = sum;</span>
<a id="line692"></a><span class="lineno"> 692</span><span class="line">    }</span>
<a id="line693"></a><span class="lineno"> 693</span><span class="line">  }</span>
<a id="line694"></a><span class="lineno"> 694</span><span class="line">#endif</span>
<a id="line695"></a><span class="lineno"> 695</span><span class="line">}</span>
<a id="line696"></a><span class="lineno"> 696</span>
<a id="line697"></a><span class="lineno"> 697</span>
<a id="line698"></a><span class="lineno"> 698</span>
<a id="line699"></a><span class="lineno"> 699</span><span class="line"><span class="comment">/// Perform edge portion of 2-D convolution with same region of support.</span></span>
<a id="line700"></a><span class="lineno"> 700</span>
<a id="line701"></a><span class="lineno"> 701</span><span class="line"><span class="comment">/// conv_same = conv_min + conv_same_edge</span></span>
<a id="line702"></a><span class="lineno"> 702</span>
<a id="line703"></a><span class="lineno"> 703</span><span class="line">template &lt;typename T&gt;</span>
<a id="line704"></a><span class="lineno"> 704</span><span class="line">inline <span class="keyword">void</span></span>
<a id="line705"></a><span class="lineno"> 705</span><span class="line"><a href="../../../../Scopes/vsip/impl.html#conv_same_edge_lT_S_clength_type_clength_type_cstride_type_cstride_type_cT_S_clength_type_clength_type_cstride_type_cstride_type_cT_S_clength_type_clength_type_cstride_type_cstride_type_clength_type_r" title="function template vsip::impl::conv_same_edge(T*,length_type,length_type,stride_type,stride_type,T*,length_type,length_type,stride_type,stride_type,T*,length_type,length_type,stride_type,stride_type,length_type)">conv_same_edge</a>(</span>
<a id="line706"></a><span class="lineno"> 706</span><span class="line">  T*          coeff,</span>
<a id="line707"></a><span class="lineno"> 707</span><span class="line">  <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a> coeff_rows,	<span class="comment">// Mr</span></span>
<a id="line708"></a><span class="lineno"> 708</span><span class="line">  <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a> coeff_cols,	<span class="comment">// Mc</span></span>
<a id="line709"></a><span class="lineno"> 709</span><span class="line">  <a href="../../../../Scopes/vsip.html#stride_type" title="typedef vsip::stride_type">stride_type</a> coeff_row_stride,</span>
<a id="line710"></a><span class="lineno"> 710</span><span class="line">  <a href="../../../../Scopes/vsip.html#stride_type" title="typedef vsip::stride_type">stride_type</a> coeff_col_stride,</span>
<a id="line711"></a><span class="lineno"> 711</span>
<a id="line712"></a><span class="lineno"> 712</span><span class="line">  T*          in,</span>
<a id="line713"></a><span class="lineno"> 713</span><span class="line">  <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a> in_rows,		<span class="comment">// Nr</span></span>
<a id="line714"></a><span class="lineno"> 714</span><span class="line">  <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a> in_cols,		<span class="comment">// Nc</span></span>
<a id="line715"></a><span class="lineno"> 715</span><span class="line">  <a href="../../../../Scopes/vsip.html#stride_type" title="typedef vsip::stride_type">stride_type</a> in_row_stride,</span>
<a id="line716"></a><span class="lineno"> 716</span><span class="line">  <a href="../../../../Scopes/vsip.html#stride_type" title="typedef vsip::stride_type">stride_type</a> in_col_stride,</span>
<a id="line717"></a><span class="lineno"> 717</span>
<a id="line718"></a><span class="lineno"> 718</span><span class="line">  T*          out,</span>
<a id="line719"></a><span class="lineno"> 719</span><span class="line">  <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a> out_rows,		<span class="comment">// Pr</span></span>
<a id="line720"></a><span class="lineno"> 720</span><span class="line">  <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a> out_cols,		<span class="comment">// Pc</span></span>
<a id="line721"></a><span class="lineno"> 721</span><span class="line">  <a href="../../../../Scopes/vsip.html#stride_type" title="typedef vsip::stride_type">stride_type</a> out_row_stride,</span>
<a id="line722"></a><span class="lineno"> 722</span><span class="line">  <a href="../../../../Scopes/vsip.html#stride_type" title="typedef vsip::stride_type">stride_type</a> out_col_stride,</span>
<a id="line723"></a><span class="lineno"> 723</span>
<a id="line724"></a><span class="lineno"> 724</span><span class="line">  <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a> decimation)</span>
<a id="line725"></a><span class="lineno"> 725</span><span class="line">{</span>
<a id="line726"></a><span class="lineno"> 726</span><span class="line">  <span class="keyword">typedef</span> <a href="../../../../Scopes/vsip/impl/Convolution_accum_trait.html#sum_type" title="typedef vsip::impl::Convolution_accum_trait::sum_type">typename Convolution_accum_trait&lt;T&gt;::sum_type</a> <a href="" title="typedef sum_type">sum_type</a>;</span>
<a id="line727"></a><span class="lineno"> 727</span>
<a id="line728"></a><span class="lineno"> 728</span><span class="line">  <span class="keyword">for</span> (<a href="../../../../Scopes/vsip.html#index_type" title="typedef vsip::index_type">index_type</a> <a href="" title="local variable `for::r">r</a>=<span class="literal">0</span>; <a href="" title="local variable `for::r">r</a>&lt;<a href="" title="parameter out_rows">out_rows</a>; ++<a href="" title="local variable `for::r">r</a>)</span>
<a id="line729"></a><span class="lineno"> 729</span><span class="line">  {</span>
<a id="line730"></a><span class="lineno"> 730</span><span class="line">    <a href="../../../../Scopes/vsip.html#index_type" title="typedef vsip::index_type">index_type</a> <a href="" title="local variable `for::ir">ir</a> = <a href="" title="local variable `for::r">r</a>*<a href="" title="parameter decimation">decimation</a> + (<a href="" title="parameter coeff_rows">coeff_rows</a>/<span class="literal">2</span>);</span>
<a id="line731"></a><span class="lineno"> 731</span>
<a id="line732"></a><span class="lineno"> 732</span><span class="line">    <span class="keyword">for</span> (<a href="../../../../Scopes/vsip.html#index_type" title="typedef vsip::index_type">index_type</a> <a href="" title="local variable `for::`for::c">c</a>=<span class="literal">0</span>; <a href="" title="local variable `for::`for::c">c</a>&lt;<a href="" title="parameter out_cols">out_cols</a>; ++<a href="" title="local variable `for::`for::c">c</a>)</span>
<a id="line733"></a><span class="lineno"> 733</span><span class="line">    {</span>
<a id="line734"></a><span class="lineno"> 734</span><span class="line">      <a href="../../../../Scopes/vsip.html#index_type" title="typedef vsip::index_type">index_type</a> <a href="" title="local variable `for::`for::ic">ic</a> = <a href="" title="local variable `for::`for::c">c</a>*<a href="" title="parameter decimation">decimation</a> + (<a href="" title="parameter coeff_cols">coeff_cols</a>/<span class="literal">2</span>);</span>
<a id="line735"></a><span class="lineno"> 735</span>
<a id="line736"></a><span class="lineno"> 736</span><span class="line">      <span class="keyword">if</span> ((<a href="" title="local variable `for::r">r</a> &lt; <a href="" title="parameter coeff_rows">coeff_rows</a>/<span class="literal">2</span> || <a href="" title="local variable `for::r">r</a> &gt;= <a href="" title="parameter out_rows">out_rows</a>-(<a href="" title="parameter coeff_rows">coeff_rows</a>/<span class="literal">2</span>)) ||</span>
<a id="line737"></a><span class="lineno"> 737</span><span class="line">	  (<a href="" title="local variable `for::`for::c">c</a> &lt; <a href="" title="parameter coeff_cols">coeff_cols</a>/<span class="literal">2</span> || <a href="" title="local variable `for::`for::c">c</a> &gt;= <a href="" title="parameter out_cols">out_cols</a>-(<a href="" title="parameter coeff_cols">coeff_cols</a>/<span class="literal">2</span>)))</span>
<a id="line738"></a><span class="lineno"> 738</span><span class="line">      {</span>
<a id="line739"></a><span class="lineno"> 739</span><span class="line">	<a href="" title="typedef sum_type">sum_type</a> <a href="" title="local variable `for::`for::`if::sum">sum</a> = sum_type();</span>
<a id="line740"></a><span class="lineno"> 740</span>
<a id="line741"></a><span class="lineno"> 741</span><span class="line">	<span class="keyword">for</span> (<a href="../../../../Scopes/vsip.html#index_type" title="typedef vsip::index_type">index_type</a> <a href="" title="local variable `for::`for::`if::`for::rr">rr</a>=<span class="literal">0</span>; <a href="" title="local variable `for::`for::`if::`for::rr">rr</a>&lt;<a href="" title="parameter coeff_rows">coeff_rows</a>; ++<a href="" title="local variable `for::`for::`if::`for::rr">rr</a>)</span>
<a id="line742"></a><span class="lineno"> 742</span><span class="line">	{</span>
<a id="line743"></a><span class="lineno"> 743</span><span class="line">	  <span class="keyword">for</span> (<a href="../../../../Scopes/vsip.html#index_type" title="typedef vsip::index_type">index_type</a> <a href="" title="local variable `for::`for::`if::`for::`for::cc">cc</a>=<span class="literal">0</span>; <a href="" title="local variable `for::`for::`if::`for::`for::cc">cc</a>&lt;<a href="" title="parameter coeff_cols">coeff_cols</a>; ++<a href="" title="local variable `for::`for::`if::`for::`for::cc">cc</a>)</span>
<a id="line744"></a><span class="lineno"> 744</span><span class="line">	  {</span>
<a id="line745"></a><span class="lineno"> 745</span>
<a id="line746"></a><span class="lineno"> 746</span><span class="line">	    <span class="keyword">if</span> (<a href="" title="local variable `for::ir">ir</a> &gt;= <a href="" title="local variable `for::`for::`if::`for::rr">rr</a> &amp;&amp; <a href="" title="local variable `for::ir">ir</a>-<a href="" title="local variable `for::`for::`if::`for::rr">rr</a> &lt; <a href="" title="parameter in_rows">in_rows</a> &amp;&amp; <a href="" title="local variable `for::`for::ic">ic</a> &gt;= <a href="" title="local variable `for::`for::`if::`for::`for::cc">cc</a> &amp;&amp; <a href="" title="local variable `for::`for::ic">ic</a>-<a href="" title="local variable `for::`for::`if::`for::`for::cc">cc</a> &lt; <a href="" title="parameter in_cols">in_cols</a>) </span>
<a id="line747"></a><span class="lineno"> 747</span><span class="line">	    {</span>
<a id="line748"></a><span class="lineno"> 748</span><span class="line">	      <a href="" title="local variable `for::`for::`if::sum">sum</a> += <a href="" title="parameter coeff">coeff</a>[<a href="" title="local variable `for::`for::`if::`for::rr">rr</a>*<a href="" title="parameter coeff_row_stride">coeff_row_stride</a> + <a href="" title="local variable `for::`for::`if::`for::`for::cc">cc</a>*<a href="" title="parameter coeff_col_stride">coeff_col_stride</a>] *</span>
<a id="line749"></a><span class="lineno"> 749</span><span class="line">		     <a href="" title="parameter in">in</a>[(<a href="" title="local variable `for::ir">ir</a>-<a href="" title="local variable `for::`for::`if::`for::rr">rr</a>) * <a href="" title="parameter in_row_stride">in_row_stride</a> + (<a href="" title="local variable `for::`for::ic">ic</a>-<a href="" title="local variable `for::`for::`if::`for::`for::cc">cc</a>) * <a href="" title="parameter in_col_stride">in_col_stride</a>];</span>
<a id="line750"></a><span class="lineno"> 750</span><span class="line">	    }</span>
<a id="line751"></a><span class="lineno"> 751</span><span class="line">	  }</span>
<a id="line752"></a><span class="lineno"> 752</span><span class="line">	}</span>
<a id="line753"></a><span class="lineno"> 753</span><span class="line">	<a href="" title="parameter out">out</a>[<a href="" title="local variable `for::r">r</a> * <a href="" title="parameter out_row_stride">out_row_stride</a> + <a href="" title="local variable `for::`for::c">c</a> * <a href="" title="parameter out_col_stride">out_col_stride</a>] = <a href="" title="local variable `for::`for::`if::sum">sum</a>;</span>
<a id="line754"></a><span class="lineno"> 754</span><span class="line">      }</span>
<a id="line755"></a><span class="lineno"> 755</span><span class="line">    }</span>
<a id="line756"></a><span class="lineno"> 756</span><span class="line">  }</span>
<a id="line757"></a><span class="lineno"> 757</span><span class="line">}</span>
<a id="line758"></a><span class="lineno"> 758</span>
<a id="line759"></a><span class="lineno"> 759</span><span class="line"><span class="comment">/***********************************************************************</span></span>
<a id="line760"></a><span class="lineno"> 760</span><span class="line"><span class="comment">  2-D Convolutions (split)</span></span>
<a id="line761"></a><span class="lineno"> 761</span><span class="line"><span class="comment">***********************************************************************/</span></span>
<a id="line762"></a><span class="lineno"> 762</span>
<a id="line763"></a><span class="lineno"> 763</span><span class="line"><span class="comment">/// Perform 2-D convolution with full region of support.</span></span>
<a id="line764"></a><span class="lineno"> 764</span>
<a id="line765"></a><span class="lineno"> 765</span><span class="line">template &lt;typename T&gt;</span>
<a id="line766"></a><span class="lineno"> 766</span><span class="line">inline <span class="keyword">void</span></span>
<a id="line767"></a><span class="lineno"> 767</span><span class="line"><a href="" title="function template vsip::impl::conv_full(std::pair&lt;T*,T*&gt;,length_type,length_type,stride_type,stride_type,std::pair&lt;T*,T*&gt;,length_type,length_type,stride_type,stride_type,std::pair&lt;T*,T*&gt;,length_type,length_type,stride_type,stride_type,length_type)">conv_full</a>(</span>
<a id="line768"></a><span class="lineno"> 768</span><span class="line">  std::<a href="" title="struct std::pair">pair</a>&lt;T*, T*&gt; coeff,</span>
<a id="line769"></a><span class="lineno"> 769</span><span class="line">  <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a> coeff_rows,	<span class="comment">// Mr</span></span>
<a id="line770"></a><span class="lineno"> 770</span><span class="line">  <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a> coeff_cols,	<span class="comment">// Mc</span></span>
<a id="line771"></a><span class="lineno"> 771</span><span class="line">  <a href="../../../../Scopes/vsip.html#stride_type" title="typedef vsip::stride_type">stride_type</a> coeff_row_stride,</span>
<a id="line772"></a><span class="lineno"> 772</span><span class="line">  <a href="../../../../Scopes/vsip.html#stride_type" title="typedef vsip::stride_type">stride_type</a> coeff_col_stride,</span>
<a id="line773"></a><span class="lineno"> 773</span>
<a id="line774"></a><span class="lineno"> 774</span><span class="line">  std::<a href="" title="struct std::pair">pair</a>&lt;T*, T*&gt; in,</span>
<a id="line775"></a><span class="lineno"> 775</span><span class="line">  <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a> in_rows,		<span class="comment">// Nr</span></span>
<a id="line776"></a><span class="lineno"> 776</span><span class="line">  <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a> in_cols,		<span class="comment">// Nc</span></span>
<a id="line777"></a><span class="lineno"> 777</span><span class="line">  <a href="../../../../Scopes/vsip.html#stride_type" title="typedef vsip::stride_type">stride_type</a> in_row_stride,</span>
<a id="line778"></a><span class="lineno"> 778</span><span class="line">  <a href="../../../../Scopes/vsip.html#stride_type" title="typedef vsip::stride_type">stride_type</a> in_col_stride,</span>
<a id="line779"></a><span class="lineno"> 779</span>
<a id="line780"></a><span class="lineno"> 780</span><span class="line">  std::<a href="" title="struct std::pair">pair</a>&lt;T*, T*&gt; out,</span>
<a id="line781"></a><span class="lineno"> 781</span><span class="line">  <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a> out_rows,		<span class="comment">// Pr</span></span>
<a id="line782"></a><span class="lineno"> 782</span><span class="line">  <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a> out_cols,		<span class="comment">// Pc</span></span>
<a id="line783"></a><span class="lineno"> 783</span><span class="line">  <a href="../../../../Scopes/vsip.html#stride_type" title="typedef vsip::stride_type">stride_type</a> out_row_stride,</span>
<a id="line784"></a><span class="lineno"> 784</span><span class="line">  <a href="../../../../Scopes/vsip.html#stride_type" title="typedef vsip::stride_type">stride_type</a> out_col_stride,</span>
<a id="line785"></a><span class="lineno"> 785</span>
<a id="line786"></a><span class="lineno"> 786</span><span class="line">  <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a> decimation)</span>
<a id="line787"></a><span class="lineno"> 787</span><span class="line">{</span>
<a id="line788"></a><span class="lineno"> 788</span><span class="line">  <span class="keyword">typedef</span> <a href="../../../../Scopes/vsip/impl/Convolution_accum_trait.html#sum_type" title="typedef vsip::impl::Convolution_accum_trait::sum_type">typename Convolution_accum_trait&lt;complex&lt;T&gt; &gt;::sum_type</a> <a href="" title="typedef sum_type">sum_type</a>;</span>
<a id="line789"></a><span class="lineno"> 789</span><span class="line">  <span class="keyword">typedef</span> <a href="../../../../Scopes/vsip/impl/Storage.html" title="struct vsip::impl::Storage">Storage</a>&lt;<a href="../../../../Scopes/vsip/impl/Cmplx_split_fmt.html" title="struct vsip::impl::Cmplx_split_fmt">Cmplx_split_fmt</a>, complex&lt;T&gt; &gt; <a href="" title="typedef storage_type">storage_type</a>;</span>
<a id="line790"></a><span class="lineno"> 790</span>
<a id="line791"></a><span class="lineno"> 791</span><span class="line">  <span class="keyword">for</span> (<a href="../../../../Scopes/vsip.html#index_type" title="typedef vsip::index_type">index_type</a> <a href="" title="local variable `for::r">r</a>=<span class="literal">0</span>; <a href="" title="local variable `for::r">r</a>&lt;<a href="" title="parameter out_rows">out_rows</a>; ++<a href="" title="local variable `for::r">r</a>)</span>
<a id="line792"></a><span class="lineno"> 792</span><span class="line">  {</span>
<a id="line793"></a><span class="lineno"> 793</span><span class="line">    <span class="keyword">for</span> (<a href="../../../../Scopes/vsip.html#index_type" title="typedef vsip::index_type">index_type</a> <a href="" title="local variable `for::`for::c">c</a>=<span class="literal">0</span>; <a href="" title="local variable `for::`for::c">c</a>&lt;<a href="" title="parameter out_cols">out_cols</a>; ++<a href="" title="local variable `for::`for::c">c</a>)</span>
<a id="line794"></a><span class="lineno"> 794</span><span class="line">    {</span>
<a id="line795"></a><span class="lineno"> 795</span><span class="line">      <a href="" title="typedef sum_type">sum_type</a> <a href="" title="local variable `for::`for::sum">sum</a> = sum_type();</span>
<a id="line796"></a><span class="lineno"> 796</span>
<a id="line797"></a><span class="lineno"> 797</span><span class="line">      <span class="keyword">for</span> (<a href="../../../../Scopes/vsip.html#index_type" title="typedef vsip::index_type">index_type</a> <a href="" title="local variable `for::`for::`for::rr">rr</a>=<span class="literal">0</span>; <a href="" title="local variable `for::`for::`for::rr">rr</a>&lt;<a href="" title="parameter coeff_rows">coeff_rows</a>; ++<a href="" title="local variable `for::`for::`for::rr">rr</a>)</span>
<a id="line798"></a><span class="lineno"> 798</span><span class="line">      {</span>
<a id="line799"></a><span class="lineno"> 799</span><span class="line">	<span class="keyword">for</span> (<a href="../../../../Scopes/vsip.html#index_type" title="typedef vsip::index_type">index_type</a> <a href="" title="local variable `for::`for::`for::`for::cc">cc</a>=<span class="literal">0</span>; <a href="" title="local variable `for::`for::`for::`for::cc">cc</a>&lt;<a href="" title="parameter coeff_cols">coeff_cols</a>; ++<a href="" title="local variable `for::`for::`for::`for::cc">cc</a>)</span>
<a id="line800"></a><span class="lineno"> 800</span><span class="line">	{</span>
<a id="line801"></a><span class="lineno"> 801</span><span class="line">	  <span class="keyword">if</span> (<a href="" title="local variable `for::r">r</a>*<a href="" title="parameter decimation">decimation</a> &gt;= <a href="" title="local variable `for::`for::`for::rr">rr</a> &amp;&amp; <a href="" title="local variable `for::r">r</a>*<a href="" title="parameter decimation">decimation</a>-<a href="" title="local variable `for::`for::`for::rr">rr</a> &lt; <a href="" title="parameter in_rows">in_rows</a> &amp;&amp;</span>
<a id="line802"></a><span class="lineno"> 802</span><span class="line">	      <a href="" title="local variable `for::`for::c">c</a>*<a href="" title="parameter decimation">decimation</a> &gt;= <a href="" title="local variable `for::`for::`for::`for::cc">cc</a> &amp;&amp; <a href="" title="local variable `for::`for::c">c</a>*<a href="" title="parameter decimation">decimation</a>-<a href="" title="local variable `for::`for::`for::`for::cc">cc</a> &lt; <a href="" title="parameter in_cols">in_cols</a>)</span>
<a id="line803"></a><span class="lineno"> 803</span><span class="line">	  {</span>
<a id="line804"></a><span class="lineno"> 804</span><span class="line">	    <a href="" title="local variable `for::`for::sum">sum</a> = <a href="" title="local variable `for::`for::sum">sum</a> +</span>
<a id="line805"></a><span class="lineno"> 805</span><span class="line">	           <a href="../../../../Scopes/vsip/impl.html#get_lconst_Vector_LT_cBlock_R_cconst.Index_L_S_R_A_r" title="function template vsip::impl::get(const_Vector&lt;T,Block&gt;,const Index&lt;*&gt;&amp;)">storage_type::get</a>(<a href="" title="parameter coeff">coeff</a>,<a href="" title="local variable `for::`for::`for::rr">rr</a>*<a href="" title="parameter coeff_row_stride">coeff_row_stride</a> + <a href="" title="local variable `for::`for::`for::`for::cc">cc</a>*<a href="" title="parameter coeff_col_stride">coeff_col_stride</a>) *</span>
<a id="line806"></a><span class="lineno"> 806</span><span class="line">                   <a href="../../../../Scopes/vsip/impl.html#get_lconst_Vector_LT_cBlock_R_cconst.Index_L_S_R_A_r" title="function template vsip::impl::get(const_Vector&lt;T,Block&gt;,const Index&lt;*&gt;&amp;)">storage_type::get</a>(<a href="" title="parameter in">in</a>,(<a href="" title="local variable `for::r">r</a>*<a href="" title="parameter decimation">decimation</a>-<a href="" title="local variable `for::`for::`for::rr">rr</a>) * <a href="" title="parameter in_row_stride">in_row_stride</a> +</span>
<a id="line807"></a><span class="lineno"> 807</span><span class="line">		      (<a href="" title="local variable `for::`for::c">c</a>*<a href="" title="parameter decimation">decimation</a>-<a href="" title="local variable `for::`for::`for::`for::cc">cc</a>) * <a href="" title="parameter in_col_stride">in_col_stride</a>);</span>
<a id="line808"></a><span class="lineno"> 808</span><span class="line">	  }</span>
<a id="line809"></a><span class="lineno"> 809</span><span class="line">	}</span>
<a id="line810"></a><span class="lineno"> 810</span><span class="line">      }</span>
<a id="line811"></a><span class="lineno"> 811</span><span class="line">      <a href="" title="function template vsip::impl::put(Block&amp;,const Index&lt;*&gt;&amp;,const Block::value_type&amp;)">storage_type::put</a>(<a href="" title="parameter out">out</a>,<a href="" title="local variable `for::r">r</a> * <a href="" title="parameter out_row_stride">out_row_stride</a> + <a href="" title="local variable `for::`for::c">c</a> * <a href="" title="parameter out_col_stride">out_col_stride</a>,<a href="" title="local variable `for::`for::sum">sum</a>);</span>
<a id="line812"></a><span class="lineno"> 812</span><span class="line">    }</span>
<a id="line813"></a><span class="lineno"> 813</span><span class="line">  }</span>
<a id="line814"></a><span class="lineno"> 814</span><span class="line">}</span>
<a id="line815"></a><span class="lineno"> 815</span>
<a id="line816"></a><span class="lineno"> 816</span>
<a id="line817"></a><span class="lineno"> 817</span>
<a id="line818"></a><span class="lineno"> 818</span><span class="line"><span class="comment">/// Perform 2-D convolution with same region of support.</span></span>
<a id="line819"></a><span class="lineno"> 819</span>
<a id="line820"></a><span class="lineno"> 820</span><span class="line">template &lt;typename T&gt;</span>
<a id="line821"></a><span class="lineno"> 821</span><span class="line">inline <span class="keyword">void</span></span>
<a id="line822"></a><span class="lineno"> 822</span><span class="line"><a href="" title="function template vsip::impl::conv_same(std::pair&lt;T*,T*&gt;,length_type,length_type,stride_type,stride_type,std::pair&lt;T*,T*&gt;,length_type,length_type,stride_type,stride_type,std::pair&lt;T*,T*&gt;,length_type,length_type,stride_type,stride_type,length_type)">conv_same</a>(</span>
<a id="line823"></a><span class="lineno"> 823</span><span class="line">  std::<a href="" title="struct std::pair">pair</a>&lt;T*, T*&gt; coeff,</span>
<a id="line824"></a><span class="lineno"> 824</span><span class="line">  <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a> coeff_rows,	<span class="comment">// Mr</span></span>
<a id="line825"></a><span class="lineno"> 825</span><span class="line">  <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a> coeff_cols,	<span class="comment">// Mc</span></span>
<a id="line826"></a><span class="lineno"> 826</span><span class="line">  <a href="../../../../Scopes/vsip.html#stride_type" title="typedef vsip::stride_type">stride_type</a> coeff_row_stride,</span>
<a id="line827"></a><span class="lineno"> 827</span><span class="line">  <a href="../../../../Scopes/vsip.html#stride_type" title="typedef vsip::stride_type">stride_type</a> coeff_col_stride,</span>
<a id="line828"></a><span class="lineno"> 828</span>
<a id="line829"></a><span class="lineno"> 829</span><span class="line">  std::<a href="" title="struct std::pair">pair</a>&lt;T*, T*&gt; in,</span>
<a id="line830"></a><span class="lineno"> 830</span><span class="line">  <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a> in_rows,		<span class="comment">// Nr</span></span>
<a id="line831"></a><span class="lineno"> 831</span><span class="line">  <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a> in_cols,		<span class="comment">// Nc</span></span>
<a id="line832"></a><span class="lineno"> 832</span><span class="line">  <a href="../../../../Scopes/vsip.html#stride_type" title="typedef vsip::stride_type">stride_type</a> in_row_stride,</span>
<a id="line833"></a><span class="lineno"> 833</span><span class="line">  <a href="../../../../Scopes/vsip.html#stride_type" title="typedef vsip::stride_type">stride_type</a> in_col_stride,</span>
<a id="line834"></a><span class="lineno"> 834</span>
<a id="line835"></a><span class="lineno"> 835</span><span class="line">  std::<a href="" title="struct std::pair">pair</a>&lt;T*, T*&gt; out,</span>
<a id="line836"></a><span class="lineno"> 836</span><span class="line">  <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a> out_rows,		<span class="comment">// Pr</span></span>
<a id="line837"></a><span class="lineno"> 837</span><span class="line">  <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a> out_cols,		<span class="comment">// Pc</span></span>
<a id="line838"></a><span class="lineno"> 838</span><span class="line">  <a href="../../../../Scopes/vsip.html#stride_type" title="typedef vsip::stride_type">stride_type</a> out_row_stride,</span>
<a id="line839"></a><span class="lineno"> 839</span><span class="line">  <a href="../../../../Scopes/vsip.html#stride_type" title="typedef vsip::stride_type">stride_type</a> out_col_stride,</span>
<a id="line840"></a><span class="lineno"> 840</span>
<a id="line841"></a><span class="lineno"> 841</span><span class="line">  <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a> decimation)</span>
<a id="line842"></a><span class="lineno"> 842</span><span class="line">{</span>
<a id="line843"></a><span class="lineno"> 843</span><span class="line">  <span class="keyword">typedef</span> <a href="../../../../Scopes/vsip/impl/Convolution_accum_trait.html#sum_type" title="typedef vsip::impl::Convolution_accum_trait::sum_type">typename Convolution_accum_trait&lt;complex&lt;T&gt; &gt;::sum_type</a> <a href="" title="typedef sum_type">sum_type</a>;</span>
<a id="line844"></a><span class="lineno"> 844</span><span class="line">  <span class="keyword">typedef</span> <a href="../../../../Scopes/vsip/impl/Storage.html" title="struct vsip::impl::Storage">Storage</a>&lt;<a href="../../../../Scopes/vsip/impl/Cmplx_split_fmt.html" title="struct vsip::impl::Cmplx_split_fmt">Cmplx_split_fmt</a>, complex&lt;T&gt; &gt; <a href="" title="typedef storage_type">storage_type</a>;</span>
<a id="line845"></a><span class="lineno"> 845</span>
<a id="line846"></a><span class="lineno"> 846</span><span class="line">  <span class="keyword">for</span> (<a href="../../../../Scopes/vsip.html#index_type" title="typedef vsip::index_type">index_type</a> <a href="" title="local variable `for::r">r</a>=<span class="literal">0</span>; <a href="" title="local variable `for::r">r</a>&lt;<a href="" title="parameter out_rows">out_rows</a>; ++<a href="" title="local variable `for::r">r</a>)</span>
<a id="line847"></a><span class="lineno"> 847</span><span class="line">  {</span>
<a id="line848"></a><span class="lineno"> 848</span><span class="line">    <a href="../../../../Scopes/vsip.html#index_type" title="typedef vsip::index_type">index_type</a> <a href="" title="local variable `for::ir">ir</a> = <a href="" title="local variable `for::r">r</a>*<a href="" title="parameter decimation">decimation</a> + (<a href="" title="parameter coeff_rows">coeff_rows</a>/<span class="literal">2</span>);</span>
<a id="line849"></a><span class="lineno"> 849</span>
<a id="line850"></a><span class="lineno"> 850</span><span class="line">    <span class="keyword">for</span> (<a href="../../../../Scopes/vsip.html#index_type" title="typedef vsip::index_type">index_type</a> <a href="" title="local variable `for::`for::c">c</a>=<span class="literal">0</span>; <a href="" title="local variable `for::`for::c">c</a>&lt;<a href="" title="parameter out_cols">out_cols</a>; ++<a href="" title="local variable `for::`for::c">c</a>)</span>
<a id="line851"></a><span class="lineno"> 851</span><span class="line">    {</span>
<a id="line852"></a><span class="lineno"> 852</span><span class="line">      <a href="../../../../Scopes/vsip.html#index_type" title="typedef vsip::index_type">index_type</a> <a href="" title="local variable `for::`for::ic">ic</a> = <a href="" title="local variable `for::`for::c">c</a>*<a href="" title="parameter decimation">decimation</a> + (<a href="" title="parameter coeff_cols">coeff_cols</a>/<span class="literal">2</span>);</span>
<a id="line853"></a><span class="lineno"> 853</span>
<a id="line854"></a><span class="lineno"> 854</span><span class="line">      <a href="" title="typedef sum_type">sum_type</a> <a href="" title="local variable `for::`for::sum">sum</a> = sum_type();</span>
<a id="line855"></a><span class="lineno"> 855</span>
<a id="line856"></a><span class="lineno"> 856</span><span class="line">      <span class="keyword">for</span> (<a href="../../../../Scopes/vsip.html#index_type" title="typedef vsip::index_type">index_type</a> <a href="" title="local variable `for::`for::`for::rr">rr</a>=<span class="literal">0</span>; <a href="" title="local variable `for::`for::`for::rr">rr</a>&lt;<a href="" title="parameter coeff_rows">coeff_rows</a>; ++<a href="" title="local variable `for::`for::`for::rr">rr</a>)</span>
<a id="line857"></a><span class="lineno"> 857</span><span class="line">      {</span>
<a id="line858"></a><span class="lineno"> 858</span><span class="line">	<span class="keyword">for</span> (<a href="../../../../Scopes/vsip.html#index_type" title="typedef vsip::index_type">index_type</a> <a href="" title="local variable `for::`for::`for::`for::cc">cc</a>=<span class="literal">0</span>; <a href="" title="local variable `for::`for::`for::`for::cc">cc</a>&lt;<a href="" title="parameter coeff_cols">coeff_cols</a>; ++<a href="" title="local variable `for::`for::`for::`for::cc">cc</a>)</span>
<a id="line859"></a><span class="lineno"> 859</span><span class="line">	{</span>
<a id="line860"></a><span class="lineno"> 860</span>
<a id="line861"></a><span class="lineno"> 861</span><span class="line">	  <span class="keyword">if</span> (<a href="" title="local variable `for::ir">ir</a> &gt;= <a href="" title="local variable `for::`for::`for::rr">rr</a> &amp;&amp; <a href="" title="local variable `for::ir">ir</a>-<a href="" title="local variable `for::`for::`for::rr">rr</a> &lt; <a href="" title="parameter in_rows">in_rows</a> &amp;&amp; <a href="" title="local variable `for::`for::ic">ic</a> &gt;= <a href="" title="local variable `for::`for::`for::`for::cc">cc</a> &amp;&amp; <a href="" title="local variable `for::`for::ic">ic</a>-<a href="" title="local variable `for::`for::`for::`for::cc">cc</a> &lt; <a href="" title="parameter in_cols">in_cols</a>) </span>
<a id="line862"></a><span class="lineno"> 862</span><span class="line">	  {</span>
<a id="line863"></a><span class="lineno"> 863</span><span class="line">	    <a href="" title="local variable `for::`for::sum">sum</a> = <a href="" title="local variable `for::`for::sum">sum</a> +</span>
<a id="line864"></a><span class="lineno"> 864</span><span class="line">	           <a href="../../../../Scopes/vsip/impl.html#get_lconst_Vector_LT_cBlock_R_cconst.Index_L_S_R_A_r" title="function template vsip::impl::get(const_Vector&lt;T,Block&gt;,const Index&lt;*&gt;&amp;)">storage_type::get</a>(<a href="" title="parameter coeff">coeff</a>,<a href="" title="local variable `for::`for::`for::rr">rr</a>*<a href="" title="parameter coeff_row_stride">coeff_row_stride</a> + <a href="" title="local variable `for::`for::`for::`for::cc">cc</a>*<a href="" title="parameter coeff_col_stride">coeff_col_stride</a>) *</span>
<a id="line865"></a><span class="lineno"> 865</span><span class="line">	           <a href="../../../../Scopes/vsip/impl.html#get_lconst_Vector_LT_cBlock_R_cconst.Index_L_S_R_A_r" title="function template vsip::impl::get(const_Vector&lt;T,Block&gt;,const Index&lt;*&gt;&amp;)">storage_type::get</a>(<a href="" title="parameter in">in</a>,(<a href="" title="local variable `for::ir">ir</a>-<a href="" title="local variable `for::`for::`for::rr">rr</a>) * <a href="" title="parameter in_row_stride">in_row_stride</a> + (<a href="" title="local variable `for::`for::ic">ic</a>-<a href="" title="local variable `for::`for::`for::`for::cc">cc</a>) * <a href="" title="parameter in_col_stride">in_col_stride</a>);</span>
<a id="line866"></a><span class="lineno"> 866</span><span class="line">	  }</span>
<a id="line867"></a><span class="lineno"> 867</span><span class="line">	}</span>
<a id="line868"></a><span class="lineno"> 868</span><span class="line">      }</span>
<a id="line869"></a><span class="lineno"> 869</span><span class="line">      <a href="" title="function template vsip::impl::put(Block&amp;,const Index&lt;*&gt;&amp;,const Block::value_type&amp;)">storage_type::put</a>(<a href="" title="parameter out">out</a>,<a href="" title="local variable `for::r">r</a> * <a href="" title="parameter out_row_stride">out_row_stride</a> + <a href="" title="local variable `for::`for::c">c</a> * <a href="" title="parameter out_col_stride">out_col_stride</a>,<a href="" title="local variable `for::`for::sum">sum</a>);</span>
<a id="line870"></a><span class="lineno"> 870</span><span class="line">    }</span>
<a id="line871"></a><span class="lineno"> 871</span><span class="line">  }</span>
<a id="line872"></a><span class="lineno"> 872</span><span class="line">}</span>
<a id="line873"></a><span class="lineno"> 873</span>
<a id="line874"></a><span class="lineno"> 874</span>
<a id="line875"></a><span class="lineno"> 875</span>
<a id="line876"></a><span class="lineno"> 876</span><span class="line"><span class="comment">/// Perform 2-D convolution with minimal region of support.</span></span>
<a id="line877"></a><span class="lineno"> 877</span>
<a id="line878"></a><span class="lineno"> 878</span><span class="line">template &lt;typename T&gt;</span>
<a id="line879"></a><span class="lineno"> 879</span><span class="line">inline <span class="keyword">void</span></span>
<a id="line880"></a><span class="lineno"> 880</span><span class="line"><a href="" title="function template vsip::impl::conv_min(std::pair&lt;T*,T*&gt;,length_type,length_type,stride_type,stride_type,std::pair&lt;T*,T*&gt;,length_type,length_type,stride_type,stride_type,std::pair&lt;T*,T*&gt;,length_type,length_type,stride_type,stride_type,length_type)">conv_min</a>(</span>
<a id="line881"></a><span class="lineno"> 881</span><span class="line">  std::<a href="" title="struct std::pair">pair</a>&lt;T*, T*&gt; coeff,</span>
<a id="line882"></a><span class="lineno"> 882</span><span class="line">  <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a> coeff_rows,	<span class="comment">// Mr</span></span>
<a id="line883"></a><span class="lineno"> 883</span><span class="line">  <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a> coeff_cols,	<span class="comment">// Mc</span></span>
<a id="line884"></a><span class="lineno"> 884</span><span class="line">  <a href="../../../../Scopes/vsip.html#stride_type" title="typedef vsip::stride_type">stride_type</a> coeff_row_stride,</span>
<a id="line885"></a><span class="lineno"> 885</span><span class="line">  <a href="../../../../Scopes/vsip.html#stride_type" title="typedef vsip::stride_type">stride_type</a> coeff_col_stride,</span>
<a id="line886"></a><span class="lineno"> 886</span>
<a id="line887"></a><span class="lineno"> 887</span><span class="line">  std::<a href="" title="struct std::pair">pair</a>&lt;T*, T*&gt; in,</span>
<a id="line888"></a><span class="lineno"> 888</span><span class="line">  <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a> in_rows,		<span class="comment">// Nr</span></span>
<a id="line889"></a><span class="lineno"> 889</span><span class="line">  <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a> in_cols,		<span class="comment">// Nc</span></span>
<a id="line890"></a><span class="lineno"> 890</span><span class="line">  <a href="../../../../Scopes/vsip.html#stride_type" title="typedef vsip::stride_type">stride_type</a> in_row_stride,</span>
<a id="line891"></a><span class="lineno"> 891</span><span class="line">  <a href="../../../../Scopes/vsip.html#stride_type" title="typedef vsip::stride_type">stride_type</a> in_col_stride,</span>
<a id="line892"></a><span class="lineno"> 892</span>
<a id="line893"></a><span class="lineno"> 893</span><span class="line">  std::<a href="" title="struct std::pair">pair</a>&lt;T*, T*&gt; out,</span>
<a id="line894"></a><span class="lineno"> 894</span><span class="line">  <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a> out_rows,		<span class="comment">// Pr</span></span>
<a id="line895"></a><span class="lineno"> 895</span><span class="line">  <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a> out_cols,		<span class="comment">// Pc</span></span>
<a id="line896"></a><span class="lineno"> 896</span><span class="line">  <a href="../../../../Scopes/vsip.html#stride_type" title="typedef vsip::stride_type">stride_type</a> out_row_stride,</span>
<a id="line897"></a><span class="lineno"> 897</span><span class="line">  <a href="../../../../Scopes/vsip.html#stride_type" title="typedef vsip::stride_type">stride_type</a> out_col_stride,</span>
<a id="line898"></a><span class="lineno"> 898</span>
<a id="line899"></a><span class="lineno"> 899</span><span class="line">  <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a> decimation)</span>
<a id="line900"></a><span class="lineno"> 900</span><span class="line">{</span>
<a id="line901"></a><span class="lineno"> 901</span><span class="line">  <span class="keyword">typedef</span> <a href="../../../../Scopes/vsip/impl/Convolution_accum_trait.html#sum_type" title="typedef vsip::impl::Convolution_accum_trait::sum_type">typename Convolution_accum_trait&lt;complex&lt;T&gt; &gt;::sum_type</a> <a href="" title="typedef sum_type">sum_type</a>;</span>
<a id="line902"></a><span class="lineno"> 902</span><span class="line">  <span class="keyword">typedef</span> <a href="../../../../Scopes/vsip/impl/Storage.html" title="struct vsip::impl::Storage">Storage</a>&lt;<a href="../../../../Scopes/vsip/impl/Cmplx_split_fmt.html" title="struct vsip::impl::Cmplx_split_fmt">Cmplx_split_fmt</a>, complex&lt;T&gt; &gt; <a href="" title="typedef storage_type">storage_type</a>;</span>
<a id="line903"></a><span class="lineno"> 903</span>
<a id="line904"></a><span class="lineno"> 904</span><span class="line">#if VSIP_IMPL_CONV_CORRECT_MIN_SUPPORT_SIZE</span>
<a id="line905"></a><span class="lineno"> 905</span><span class="line">  (<span class="keyword">void</span>)<a href="" title="parameter in_rows">in_rows</a>;</span>
<a id="line906"></a><span class="lineno"> 906</span><span class="line">  (<span class="keyword">void</span>)<a href="" title="parameter in_cols">in_cols</a>;</span>
<a id="line907"></a><span class="lineno"> 907</span>
<a id="line908"></a><span class="lineno"> 908</span><span class="line">  <span class="keyword">for</span> (<a href="../../../../Scopes/vsip.html#index_type" title="typedef vsip::index_type">index_type</a> <a href="" title="local variable `for::r">r</a>=<span class="literal">0</span>; <a href="" title="local variable `for::r">r</a>&lt;<a href="" title="parameter out_rows">out_rows</a>; ++<a href="" title="local variable `for::r">r</a>)</span>
<a id="line909"></a><span class="lineno"> 909</span><span class="line">  {</span>
<a id="line910"></a><span class="lineno"> 910</span><span class="line">    <a href="../../../../Scopes/vsip.html#index_type" title="typedef vsip::index_type">index_type</a> <a href="" title="local variable `for::ir">ir</a> = <a href="" title="local variable `for::r">r</a>*<a href="" title="parameter decimation">decimation</a> + (<a href="" title="parameter coeff_rows">coeff_rows</a>-<span class="literal">1</span>);</span>
<a id="line911"></a><span class="lineno"> 911</span><span class="line">    <span class="keyword">for</span> (<a href="../../../../Scopes/vsip.html#index_type" title="typedef vsip::index_type">index_type</a> <a href="" title="local variable `for::`for::c">c</a>=<span class="literal">0</span>; <a href="" title="local variable `for::`for::c">c</a>&lt;<a href="" title="parameter out_cols">out_cols</a>; ++<a href="" title="local variable `for::`for::c">c</a>)</span>
<a id="line912"></a><span class="lineno"> 912</span><span class="line">    {</span>
<a id="line913"></a><span class="lineno"> 913</span><span class="line">      <a href="../../../../Scopes/vsip.html#index_type" title="typedef vsip::index_type">index_type</a> <a href="" title="local variable `for::`for::ic">ic</a> = <a href="" title="local variable `for::`for::c">c</a>*<a href="" title="parameter decimation">decimation</a> + (<a href="" title="parameter coeff_cols">coeff_cols</a>-<span class="literal">1</span>);</span>
<a id="line914"></a><span class="lineno"> 914</span>
<a id="line915"></a><span class="lineno"> 915</span><span class="line">      <a href="" title="typedef sum_type">sum_type</a> <a href="" title="local variable `for::`for::sum">sum</a> = sum_type();</span>
<a id="line916"></a><span class="lineno"> 916</span>
<a id="line917"></a><span class="lineno"> 917</span><span class="line">      <span class="keyword">for</span> (<a href="../../../../Scopes/vsip.html#index_type" title="typedef vsip::index_type">index_type</a> <a href="" title="local variable `for::`for::`for::rr">rr</a>=<span class="literal">0</span>; <a href="" title="local variable `for::`for::`for::rr">rr</a>&lt;<a href="" title="parameter coeff_rows">coeff_rows</a>; ++<a href="" title="local variable `for::`for::`for::rr">rr</a>)</span>
<a id="line918"></a><span class="lineno"> 918</span><span class="line">      {</span>
<a id="line919"></a><span class="lineno"> 919</span><span class="line">	<span class="keyword">for</span> (<a href="../../../../Scopes/vsip.html#index_type" title="typedef vsip::index_type">index_type</a> <a href="" title="local variable `for::`for::`for::`for::cc">cc</a>=<span class="literal">0</span>; <a href="" title="local variable `for::`for::`for::`for::cc">cc</a>&lt;<a href="" title="parameter coeff_cols">coeff_cols</a>; ++<a href="" title="local variable `for::`for::`for::`for::cc">cc</a>)</span>
<a id="line920"></a><span class="lineno"> 920</span><span class="line">	{</span>
<a id="line921"></a><span class="lineno"> 921</span><span class="line">	  <a href="" title="local variable `for::`for::sum">sum</a> = <a href="" title="local variable `for::`for::sum">sum</a> +</span>
<a id="line922"></a><span class="lineno"> 922</span><span class="line">	         <a href="../../../../Scopes/vsip/impl.html#get_lconst_Vector_LT_cBlock_R_cconst.Index_L_S_R_A_r" title="function template vsip::impl::get(const_Vector&lt;T,Block&gt;,const Index&lt;*&gt;&amp;)">storage_type::get</a>(<a href="" title="parameter coeff">coeff</a>,<a href="" title="local variable `for::`for::`for::rr">rr</a>*<a href="" title="parameter coeff_row_stride">coeff_row_stride</a> + <a href="" title="local variable `for::`for::`for::`for::cc">cc</a>*<a href="" title="parameter coeff_col_stride">coeff_col_stride</a>) *</span>
<a id="line923"></a><span class="lineno"> 923</span><span class="line">	         <a href="../../../../Scopes/vsip/impl.html#get_lconst_Vector_LT_cBlock_R_cconst.Index_L_S_R_A_r" title="function template vsip::impl::get(const_Vector&lt;T,Block&gt;,const Index&lt;*&gt;&amp;)">storage_type::get</a>(<a href="" title="parameter in">in</a>,(<a href="" title="local variable `for::ir">ir</a>-<a href="" title="local variable `for::`for::`for::rr">rr</a>) * <a href="" title="parameter in_row_stride">in_row_stride</a> + (<a href="" title="local variable `for::`for::ic">ic</a>-<a href="" title="local variable `for::`for::`for::`for::cc">cc</a>) * <a href="" title="parameter in_col_stride">in_col_stride</a>);</span>
<a id="line924"></a><span class="lineno"> 924</span><span class="line">	}</span>
<a id="line925"></a><span class="lineno"> 925</span><span class="line">      }</span>
<a id="line926"></a><span class="lineno"> 926</span><span class="line">      <a href="" title="function template vsip::impl::put(Block&amp;,const Index&lt;*&gt;&amp;,const Block::value_type&amp;)">storage_type::put</a>(<a href="" title="parameter out">out</a>,<a href="" title="local variable `for::r">r</a> * <a href="" title="parameter out_row_stride">out_row_stride</a> + <a href="" title="local variable `for::`for::c">c</a> * <a href="" title="parameter out_col_stride">out_col_stride</a>,<a href="" title="local variable `for::`for::sum">sum</a>);</span>
<a id="line927"></a><span class="lineno"> 927</span><span class="line">    }</span>
<a id="line928"></a><span class="lineno"> 928</span><span class="line">  }</span>
<a id="line929"></a><span class="lineno"> 929</span><span class="line">#else</span>
<a id="line930"></a><span class="lineno"> 930</span><span class="line">  for (index_type r=0; r&lt;out_rows; ++r)</span>
<a id="line931"></a><span class="lineno"> 931</span><span class="line">  {</span>
<a id="line932"></a><span class="lineno"> 932</span><span class="line">    index_type ir = r*decimation + (coeff_rows-1);</span>
<a id="line933"></a><span class="lineno"> 933</span><span class="line">    for (index_type c=0; c&lt;out_cols; ++c)</span>
<a id="line934"></a><span class="lineno"> 934</span><span class="line">    {</span>
<a id="line935"></a><span class="lineno"> 935</span><span class="line">      index_type ic = c*decimation + (coeff_cols-1);</span>
<a id="line936"></a><span class="lineno"> 936</span>
<a id="line937"></a><span class="lineno"> 937</span><span class="line">      sum_type sum = sum_type();</span>
<a id="line938"></a><span class="lineno"> 938</span>
<a id="line939"></a><span class="lineno"> 939</span><span class="line">      for (index_type rr=0; rr&lt;coeff_rows; ++rr)</span>
<a id="line940"></a><span class="lineno"> 940</span><span class="line">      {</span>
<a id="line941"></a><span class="lineno"> 941</span><span class="line">	for (index_type cc=0; cc&lt;coeff_cols; ++cc)</span>
<a id="line942"></a><span class="lineno"> 942</span><span class="line">	{</span>
<a id="line943"></a><span class="lineno"> 943</span><span class="line">	  if (ir-rr &lt; in_rows &amp;&amp; ic-cc &lt; in_cols)</span>
<a id="line944"></a><span class="lineno"> 944</span><span class="line">	  {</span>
<a id="line945"></a><span class="lineno"> 945</span><span class="line">	    sum = sum +</span>
<a id="line946"></a><span class="lineno"> 946</span><span class="line">	           storage_type::get(coeff,rr*coeff_row_stride + cc*coeff_col_stride) *</span>
<a id="line947"></a><span class="lineno"> 947</span><span class="line">	           storage_type::get(in,(ir-rr) * in_row_stride + (ic-cc) * in_col_stride);</span>
<a id="line948"></a><span class="lineno"> 948</span><span class="line">	  }</span>
<a id="line949"></a><span class="lineno"> 949</span><span class="line">	}</span>
<a id="line950"></a><span class="lineno"> 950</span><span class="line">      }</span>
<a id="line951"></a><span class="lineno"> 951</span><span class="line">      storage_type::put(out,r * out_row_stride + c * out_col_stride,sum);</span>
<a id="line952"></a><span class="lineno"> 952</span><span class="line">    }</span>
<a id="line953"></a><span class="lineno"> 953</span><span class="line">  }</span>
<a id="line954"></a><span class="lineno"> 954</span><span class="line">#endif</span>
<a id="line955"></a><span class="lineno"> 955</span><span class="line">}</span>
<a id="line956"></a><span class="lineno"> 956</span>
<a id="line957"></a><span class="lineno"> 957</span>
<a id="line958"></a><span class="lineno"> 958</span>
<a id="line959"></a><span class="lineno"> 959</span><span class="line"><span class="comment">/// Perform edge portion of 2-D convolution with same region of support.</span></span>
<a id="line960"></a><span class="lineno"> 960</span>
<a id="line961"></a><span class="lineno"> 961</span><span class="line"><span class="comment">/// conv_same = conv_min + conv_same_edge</span></span>
<a id="line962"></a><span class="lineno"> 962</span>
<a id="line963"></a><span class="lineno"> 963</span><span class="line">template &lt;typename T&gt;</span>
<a id="line964"></a><span class="lineno"> 964</span><span class="line">inline <span class="keyword">void</span></span>
<a id="line965"></a><span class="lineno"> 965</span><span class="line"><a href="" title="function template vsip::impl::conv_same_edge(std::pair&lt;T*,T*&gt;,length_type,length_type,stride_type,stride_type,std::pair&lt;T*,T*&gt;,length_type,length_type,stride_type,stride_type,std::pair&lt;T*,T*&gt;,length_type,length_type,stride_type,stride_type,length_type)">conv_same_edge</a>(</span>
<a id="line966"></a><span class="lineno"> 966</span><span class="line">  std::<a href="" title="struct std::pair">pair</a>&lt;T*, T*&gt; coeff,</span>
<a id="line967"></a><span class="lineno"> 967</span><span class="line">  <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a> coeff_rows,	<span class="comment">// Mr</span></span>
<a id="line968"></a><span class="lineno"> 968</span><span class="line">  <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a> coeff_cols,	<span class="comment">// Mc</span></span>
<a id="line969"></a><span class="lineno"> 969</span><span class="line">  <a href="../../../../Scopes/vsip.html#stride_type" title="typedef vsip::stride_type">stride_type</a> coeff_row_stride,</span>
<a id="line970"></a><span class="lineno"> 970</span><span class="line">  <a href="../../../../Scopes/vsip.html#stride_type" title="typedef vsip::stride_type">stride_type</a> coeff_col_stride,</span>
<a id="line971"></a><span class="lineno"> 971</span>
<a id="line972"></a><span class="lineno"> 972</span><span class="line">  std::<a href="" title="struct std::pair">pair</a>&lt;T*, T*&gt; in,</span>
<a id="line973"></a><span class="lineno"> 973</span><span class="line">  <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a> in_rows,		<span class="comment">// Nr</span></span>
<a id="line974"></a><span class="lineno"> 974</span><span class="line">  <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a> in_cols,		<span class="comment">// Nc</span></span>
<a id="line975"></a><span class="lineno"> 975</span><span class="line">  <a href="../../../../Scopes/vsip.html#stride_type" title="typedef vsip::stride_type">stride_type</a> in_row_stride,</span>
<a id="line976"></a><span class="lineno"> 976</span><span class="line">  <a href="../../../../Scopes/vsip.html#stride_type" title="typedef vsip::stride_type">stride_type</a> in_col_stride,</span>
<a id="line977"></a><span class="lineno"> 977</span>
<a id="line978"></a><span class="lineno"> 978</span><span class="line">  std::<a href="" title="struct std::pair">pair</a>&lt;T*, T*&gt; out,</span>
<a id="line979"></a><span class="lineno"> 979</span><span class="line">  <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a> out_rows,		<span class="comment">// Pr</span></span>
<a id="line980"></a><span class="lineno"> 980</span><span class="line">  <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a> out_cols,		<span class="comment">// Pc</span></span>
<a id="line981"></a><span class="lineno"> 981</span><span class="line">  <a href="../../../../Scopes/vsip.html#stride_type" title="typedef vsip::stride_type">stride_type</a> out_row_stride,</span>
<a id="line982"></a><span class="lineno"> 982</span><span class="line">  <a href="../../../../Scopes/vsip.html#stride_type" title="typedef vsip::stride_type">stride_type</a> out_col_stride,</span>
<a id="line983"></a><span class="lineno"> 983</span>
<a id="line984"></a><span class="lineno"> 984</span><span class="line">  <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a> decimation)</span>
<a id="line985"></a><span class="lineno"> 985</span><span class="line">{</span>
<a id="line986"></a><span class="lineno"> 986</span><span class="line">  <span class="keyword">typedef</span> <a href="../../../../Scopes/vsip/impl/Convolution_accum_trait.html#sum_type" title="typedef vsip::impl::Convolution_accum_trait::sum_type">typename Convolution_accum_trait&lt;complex&lt;T&gt; &gt;::sum_type</a> <a href="" title="typedef sum_type">sum_type</a>;</span>
<a id="line987"></a><span class="lineno"> 987</span><span class="line">  <span class="keyword">typedef</span> <a href="../../../../Scopes/vsip/impl/Storage.html" title="struct vsip::impl::Storage">Storage</a>&lt;<a href="../../../../Scopes/vsip/impl/Cmplx_split_fmt.html" title="struct vsip::impl::Cmplx_split_fmt">Cmplx_split_fmt</a>, complex&lt;T&gt; &gt; <a href="" title="typedef storage_type">storage_type</a>;</span>
<a id="line988"></a><span class="lineno"> 988</span>
<a id="line989"></a><span class="lineno"> 989</span><span class="line">  <span class="keyword">for</span> (<a href="../../../../Scopes/vsip.html#index_type" title="typedef vsip::index_type">index_type</a> <a href="" title="local variable `for::r">r</a>=<span class="literal">0</span>; <a href="" title="local variable `for::r">r</a>&lt;<a href="" title="parameter out_rows">out_rows</a>; ++<a href="" title="local variable `for::r">r</a>)</span>
<a id="line990"></a><span class="lineno"> 990</span><span class="line">  {</span>
<a id="line991"></a><span class="lineno"> 991</span><span class="line">    <a href="../../../../Scopes/vsip.html#index_type" title="typedef vsip::index_type">index_type</a> <a href="" title="local variable `for::ir">ir</a> = <a href="" title="local variable `for::r">r</a>*<a href="" title="parameter decimation">decimation</a> + (<a href="" title="parameter coeff_rows">coeff_rows</a>/<span class="literal">2</span>);</span>
<a id="line992"></a><span class="lineno"> 992</span>
<a id="line993"></a><span class="lineno"> 993</span><span class="line">    <span class="keyword">for</span> (<a href="../../../../Scopes/vsip.html#index_type" title="typedef vsip::index_type">index_type</a> <a href="" title="local variable `for::`for::c">c</a>=<span class="literal">0</span>; <a href="" title="local variable `for::`for::c">c</a>&lt;<a href="" title="parameter out_cols">out_cols</a>; ++<a href="" title="local variable `for::`for::c">c</a>)</span>
<a id="line994"></a><span class="lineno"> 994</span><span class="line">    {</span>
<a id="line995"></a><span class="lineno"> 995</span><span class="line">      <a href="../../../../Scopes/vsip.html#index_type" title="typedef vsip::index_type">index_type</a> <a href="" title="local variable `for::`for::ic">ic</a> = <a href="" title="local variable `for::`for::c">c</a>*<a href="" title="parameter decimation">decimation</a> + (<a href="" title="parameter coeff_cols">coeff_cols</a>/<span class="literal">2</span>);</span>
<a id="line996"></a><span class="lineno"> 996</span>
<a id="line997"></a><span class="lineno"> 997</span><span class="line">      <span class="keyword">if</span> ((<a href="" title="local variable `for::r">r</a> &lt; <a href="" title="parameter coeff_rows">coeff_rows</a>/<span class="literal">2</span> || <a href="" title="local variable `for::r">r</a> &gt;= <a href="" title="parameter out_rows">out_rows</a>-(<a href="" title="parameter coeff_rows">coeff_rows</a>/<span class="literal">2</span>)) ||</span>
<a id="line998"></a><span class="lineno"> 998</span><span class="line">	  (<a href="" title="local variable `for::`for::c">c</a> &lt; <a href="" title="parameter coeff_cols">coeff_cols</a>/<span class="literal">2</span> || <a href="" title="local variable `for::`for::c">c</a> &gt;= <a href="" title="parameter out_cols">out_cols</a>-(<a href="" title="parameter coeff_cols">coeff_cols</a>/<span class="literal">2</span>)))</span>
<a id="line999"></a><span class="lineno"> 999</span><span class="line">      {</span>
<a id="line1000"></a><span class="lineno">1000</span><span class="line">	<a href="" title="typedef sum_type">sum_type</a> <a href="" title="local variable `for::`for::`if::sum">sum</a> = sum_type();</span>
<a id="line1001"></a><span class="lineno">1001</span>
<a id="line1002"></a><span class="lineno">1002</span><span class="line">	<span class="keyword">for</span> (<a href="../../../../Scopes/vsip.html#index_type" title="typedef vsip::index_type">index_type</a> <a href="" title="local variable `for::`for::`if::`for::rr">rr</a>=<span class="literal">0</span>; <a href="" title="local variable `for::`for::`if::`for::rr">rr</a>&lt;<a href="" title="parameter coeff_rows">coeff_rows</a>; ++<a href="" title="local variable `for::`for::`if::`for::rr">rr</a>)</span>
<a id="line1003"></a><span class="lineno">1003</span><span class="line">	{</span>
<a id="line1004"></a><span class="lineno">1004</span><span class="line">	  <span class="keyword">for</span> (<a href="../../../../Scopes/vsip.html#index_type" title="typedef vsip::index_type">index_type</a> <a href="" title="local variable `for::`for::`if::`for::`for::cc">cc</a>=<span class="literal">0</span>; <a href="" title="local variable `for::`for::`if::`for::`for::cc">cc</a>&lt;<a href="" title="parameter coeff_cols">coeff_cols</a>; ++<a href="" title="local variable `for::`for::`if::`for::`for::cc">cc</a>)</span>
<a id="line1005"></a><span class="lineno">1005</span><span class="line">	  {</span>
<a id="line1006"></a><span class="lineno">1006</span>
<a id="line1007"></a><span class="lineno">1007</span><span class="line">	    <span class="keyword">if</span> (<a href="" title="local variable `for::ir">ir</a> &gt;= <a href="" title="local variable `for::`for::`if::`for::rr">rr</a> &amp;&amp; <a href="" title="local variable `for::ir">ir</a>-<a href="" title="local variable `for::`for::`if::`for::rr">rr</a> &lt; <a href="" title="parameter in_rows">in_rows</a> &amp;&amp; <a href="" title="local variable `for::`for::ic">ic</a> &gt;= <a href="" title="local variable `for::`for::`if::`for::`for::cc">cc</a> &amp;&amp; <a href="" title="local variable `for::`for::ic">ic</a>-<a href="" title="local variable `for::`for::`if::`for::`for::cc">cc</a> &lt; <a href="" title="parameter in_cols">in_cols</a>) </span>
<a id="line1008"></a><span class="lineno">1008</span><span class="line">	    {</span>
<a id="line1009"></a><span class="lineno">1009</span><span class="line">	      <a href="" title="local variable `for::`for::`if::sum">sum</a> = <a href="" title="local variable `for::`for::`if::sum">sum</a> +</span>
<a id="line1010"></a><span class="lineno">1010</span><span class="line">	             <a href="../../../../Scopes/vsip/impl.html#get_lconst_Vector_LT_cBlock_R_cconst.Index_L_S_R_A_r" title="function template vsip::impl::get(const_Vector&lt;T,Block&gt;,const Index&lt;*&gt;&amp;)">storage_type::get</a>(<a href="" title="parameter coeff">coeff</a>,<a href="" title="local variable `for::`for::`if::`for::rr">rr</a>*<a href="" title="parameter coeff_row_stride">coeff_row_stride</a> + <a href="" title="local variable `for::`for::`if::`for::`for::cc">cc</a>*<a href="" title="parameter coeff_col_stride">coeff_col_stride</a>) *</span>
<a id="line1011"></a><span class="lineno">1011</span><span class="line">		     <a href="../../../../Scopes/vsip/impl.html#get_lconst_Vector_LT_cBlock_R_cconst.Index_L_S_R_A_r" title="function template vsip::impl::get(const_Vector&lt;T,Block&gt;,const Index&lt;*&gt;&amp;)">storage_type::get</a>(<a href="" title="parameter in">in</a>,(<a href="" title="local variable `for::ir">ir</a>-<a href="" title="local variable `for::`for::`if::`for::rr">rr</a>) * <a href="" title="parameter in_row_stride">in_row_stride</a> + (<a href="" title="local variable `for::`for::ic">ic</a>-<a href="" title="local variable `for::`for::`if::`for::`for::cc">cc</a>) * <a href="" title="parameter in_col_stride">in_col_stride</a>);</span>
<a id="line1012"></a><span class="lineno">1012</span><span class="line">	    }</span>
<a id="line1013"></a><span class="lineno">1013</span><span class="line">	  }</span>
<a id="line1014"></a><span class="lineno">1014</span><span class="line">	}</span>
<a id="line1015"></a><span class="lineno">1015</span><span class="line">	<a href="" title="function template vsip::impl::put(Block&amp;,const Index&lt;*&gt;&amp;,const Block::value_type&amp;)">storage_type::put</a>(<a href="" title="parameter out">out</a>,<a href="" title="local variable `for::r">r</a> * <a href="" title="parameter out_row_stride">out_row_stride</a> + <a href="" title="local variable `for::`for::c">c</a> * <a href="" title="parameter out_col_stride">out_col_stride</a>,<a href="" title="local variable `for::`for::`if::sum">sum</a>);</span>
<a id="line1016"></a><span class="lineno">1016</span><span class="line">      }</span>
<a id="line1017"></a><span class="lineno">1017</span><span class="line">    }</span>
<a id="line1018"></a><span class="lineno">1018</span><span class="line">  }</span>
<a id="line1019"></a><span class="lineno">1019</span><span class="line">}</span>
<a id="line1020"></a><span class="lineno">1020</span>
<a id="line1021"></a><span class="lineno">1021</span>
<a id="line1022"></a><span class="lineno">1022</span><span class="line"><span class="comment">/// Example of how to combine conv_min and conv_same_edge to achieve</span></span>
<a id="line1023"></a><span class="lineno">1023</span><span class="line"><span class="comment">/// conv_same.</span></span>
<a id="line1024"></a><span class="lineno">1024</span>
<a id="line1025"></a><span class="lineno">1025</span><span class="line">template &lt;typename T&gt;</span>
<a id="line1026"></a><span class="lineno">1026</span><span class="line">inline <span class="keyword">void</span></span>
<a id="line1027"></a><span class="lineno">1027</span><span class="line"><a href="../../../../Scopes/vsip/impl.html#conv_same_example_lT_S_clength_type_clength_type_cstride_type_cstride_type_cT_S_clength_type_clength_type_cstride_type_cstride_type_cT_S_clength_type_clength_type_cstride_type_cstride_type_clength_type_r" title="function template vsip::impl::conv_same_example(T*,length_type,length_type,stride_type,stride_type,T*,length_type,length_type,stride_type,stride_type,T*,length_type,length_type,stride_type,stride_type,length_type)">conv_same_example</a>(</span>
<a id="line1028"></a><span class="lineno">1028</span><span class="line">  T*          coeff,</span>
<a id="line1029"></a><span class="lineno">1029</span><span class="line">  <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a> coeff_rows,	<span class="comment">// Mr</span></span>
<a id="line1030"></a><span class="lineno">1030</span><span class="line">  <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a> coeff_cols,	<span class="comment">// Mc</span></span>
<a id="line1031"></a><span class="lineno">1031</span><span class="line">  <a href="../../../../Scopes/vsip.html#stride_type" title="typedef vsip::stride_type">stride_type</a> coeff_row_stride,</span>
<a id="line1032"></a><span class="lineno">1032</span><span class="line">  <a href="../../../../Scopes/vsip.html#stride_type" title="typedef vsip::stride_type">stride_type</a> coeff_col_stride,</span>
<a id="line1033"></a><span class="lineno">1033</span>
<a id="line1034"></a><span class="lineno">1034</span><span class="line">  T*          in,</span>
<a id="line1035"></a><span class="lineno">1035</span><span class="line">  <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a> in_rows,		<span class="comment">// Nr</span></span>
<a id="line1036"></a><span class="lineno">1036</span><span class="line">  <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a> in_cols,		<span class="comment">// Nc</span></span>
<a id="line1037"></a><span class="lineno">1037</span><span class="line">  <a href="../../../../Scopes/vsip.html#stride_type" title="typedef vsip::stride_type">stride_type</a> in_row_stride,</span>
<a id="line1038"></a><span class="lineno">1038</span><span class="line">  <a href="../../../../Scopes/vsip.html#stride_type" title="typedef vsip::stride_type">stride_type</a> in_col_stride,</span>
<a id="line1039"></a><span class="lineno">1039</span>
<a id="line1040"></a><span class="lineno">1040</span><span class="line">  T*          out,</span>
<a id="line1041"></a><span class="lineno">1041</span><span class="line">  <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a> out_rows,		<span class="comment">// Pr</span></span>
<a id="line1042"></a><span class="lineno">1042</span><span class="line">  <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a> out_cols,		<span class="comment">// Pc</span></span>
<a id="line1043"></a><span class="lineno">1043</span><span class="line">  <a href="../../../../Scopes/vsip.html#stride_type" title="typedef vsip::stride_type">stride_type</a> out_row_stride,</span>
<a id="line1044"></a><span class="lineno">1044</span><span class="line">  <a href="../../../../Scopes/vsip.html#stride_type" title="typedef vsip::stride_type">stride_type</a> out_col_stride,</span>
<a id="line1045"></a><span class="lineno">1045</span>
<a id="line1046"></a><span class="lineno">1046</span><span class="line">  <a href="../../../../Scopes/vsip.html#length_type" title="typedef vsip::length_type">length_type</a> decimation)</span>
<a id="line1047"></a><span class="lineno">1047</span><span class="line">{</span>
<a id="line1048"></a><span class="lineno">1048</span><span class="line">  // Determine the first element computed by conv_min.</span>
<a id="line1049"></a><span class="lineno">1049</span><span class="line">  <a href="../../../../Scopes/vsip.html#index_type" title="typedef vsip::index_type">index_type</a> <a href="" title="local variable n0_r">n0_r</a>  = ( (<a href="" title="parameter coeff_rows">coeff_rows</a> - <span class="literal">1</span>) - (<a href="" title="parameter coeff_rows">coeff_rows</a>/<span class="literal">2</span>) ) / <a href="" title="parameter decimation">decimation</a>;</span>
<a id="line1050"></a><span class="lineno">1050</span><span class="line">  <a href="../../../../Scopes/vsip.html#index_type" title="typedef vsip::index_type">index_type</a> <a href="" title="local variable n0_c">n0_c</a>  = ( (<a href="" title="parameter coeff_cols">coeff_cols</a> - <span class="literal">1</span>) - (<a href="" title="parameter coeff_cols">coeff_cols</a>/<span class="literal">2</span>) ) / <a href="" title="parameter decimation">decimation</a>;</span>
<a id="line1051"></a><span class="lineno">1051</span><span class="line">  <a href="../../../../Scopes/vsip.html#index_type" title="typedef vsip::index_type">index_type</a> <a href="" title="local variable res_r">res_r</a> = ( (<a href="" title="parameter coeff_rows">coeff_rows</a> - <span class="literal">1</span>) - (<a href="" title="parameter coeff_rows">coeff_rows</a>/<span class="literal">2</span>) ) % <a href="" title="parameter decimation">decimation</a>;</span>
<a id="line1052"></a><span class="lineno">1052</span><span class="line">  <a href="../../../../Scopes/vsip.html#index_type" title="typedef vsip::index_type">index_type</a> <a href="" title="local variable res_c">res_c</a> = ( (<a href="" title="parameter coeff_cols">coeff_cols</a> - <span class="literal">1</span>) - (<a href="" title="parameter coeff_cols">coeff_cols</a>/<span class="literal">2</span>) ) % <a href="" title="parameter decimation">decimation</a>;</span>
<a id="line1053"></a><span class="lineno">1053</span><span class="line">  <span class="keyword">if</span> (<a href="" title="local variable res_r">res_r</a> &gt; <span class="literal">0</span>) <a href="" title="local variable n0_r">n0_r</a> += <span class="literal">1</span>;</span>
<a id="line1054"></a><span class="lineno">1054</span><span class="line">  <span class="keyword">if</span> (<a href="" title="local variable res_c">res_c</a> &gt; <span class="literal">0</span>) <a href="" title="local variable n0_c">n0_c</a> += <span class="literal">1</span>;</span>
<a id="line1055"></a><span class="lineno">1055</span>
<a id="line1056"></a><span class="lineno">1056</span><span class="line">  // Determine the phase of the input given to conv_min.</span>
<a id="line1057"></a><span class="lineno">1057</span><span class="line">  <a href="../../../../Scopes/vsip.html#index_type" title="typedef vsip::index_type">index_type</a> <a href="" title="local variable phase_r">phase_r</a> = (<a href="" title="local variable res_r">res_r</a> == <span class="literal">0</span>) ? <span class="literal">0</span> : (<a href="" title="parameter decimation">decimation</a> - <a href="" title="local variable res_r">res_r</a>);</span>
<a id="line1058"></a><span class="lineno">1058</span><span class="line">  <a href="../../../../Scopes/vsip.html#index_type" title="typedef vsip::index_type">index_type</a> <a href="" title="local variable phase_c">phase_c</a> = (<a href="" title="local variable res_c">res_c</a> == <span class="literal">0</span>) ? <span class="literal">0</span> : (<a href="" title="parameter decimation">decimation</a> - <a href="" title="local variable res_c">res_c</a>);</span>
<a id="line1059"></a><span class="lineno">1059</span>
<a id="line1060"></a><span class="lineno">1060</span>
<a id="line1061"></a><span class="lineno">1061</span><span class="line">  // Determine the last element + 1 computed by conv_min.</span>
<a id="line1062"></a><span class="lineno">1062</span><span class="line">  <a href="../../../../Scopes/vsip.html#index_type" title="typedef vsip::index_type">index_type</a> <a href="" title="local variable n1_r">n1_r</a> = (<a href="" title="parameter in_rows">in_rows</a> - (<a href="" title="parameter coeff_rows">coeff_rows</a>/<span class="literal">2</span>)) / <a href="" title="parameter decimation">decimation</a>;</span>
<a id="line1063"></a><span class="lineno">1063</span><span class="line">  <a href="../../../../Scopes/vsip.html#index_type" title="typedef vsip::index_type">index_type</a> <a href="" title="local variable n1_c">n1_c</a> = (<a href="" title="parameter in_cols">in_cols</a> - (<a href="" title="parameter coeff_cols">coeff_cols</a>/<span class="literal">2</span>)) / <a href="" title="parameter decimation">decimation</a>;</span>
<a id="line1064"></a><span class="lineno">1064</span><span class="line">  <span class="keyword">if</span> ((<a href="" title="parameter in_rows">in_rows</a> - (<a href="" title="parameter coeff_rows">coeff_rows</a>/<span class="literal">2</span>)) % <a href="" title="parameter decimation">decimation</a> &gt; <span class="literal">0</span>) <a href="" title="local variable n1_r">n1_r</a>++;</span>
<a id="line1065"></a><span class="lineno">1065</span><span class="line">  <span class="keyword">if</span> ((<a href="" title="parameter in_cols">in_cols</a> - (<a href="" title="parameter coeff_cols">coeff_cols</a>/<span class="literal">2</span>)) % <a href="" title="parameter decimation">decimation</a> &gt; <span class="literal">0</span>) <a href="" title="local variable n1_c">n1_c</a>++;</span>
<a id="line1066"></a><span class="lineno">1066</span>
<a id="line1067"></a><span class="lineno">1067</span>
<a id="line1068"></a><span class="lineno">1068</span><span class="line">  T* <a href="" title="local variable out_adj">out_adj</a> = <a href="" title="parameter out">out</a> + (<a href="" title="local variable n0_r">n0_r</a>)*<a href="" title="parameter out_row_stride">out_row_stride</a></span>
<a id="line1069"></a><span class="lineno">1069</span><span class="line">		   + (<a href="" title="local variable n0_c">n0_c</a>)*<a href="" title="parameter out_col_stride">out_col_stride</a>;</span>
<a id="line1070"></a><span class="lineno">1070</span><span class="line">  T* <a href="" title="local variable in_adj">in_adj</a>  = <a href="" title="parameter in">in</a>  + (<a href="" title="local variable phase_r">phase_r</a>)*<a href="" title="parameter in_row_stride">in_row_stride</a></span>
<a id="line1071"></a><span class="lineno">1071</span><span class="line">		   + (<a href="" title="local variable phase_c">phase_c</a>)*<a href="" title="parameter in_col_stride">in_col_stride</a>;</span>
<a id="line1072"></a><span class="lineno">1072</span>
<a id="line1073"></a><span class="lineno">1073</span><span class="line">  <span class="keyword">if</span> (<a href="" title="local variable n1_r">n1_r</a> &gt; <a href="" title="local variable n0_r">n0_r</a> &amp;&amp; <a href="" title="local variable n1_c">n1_c</a> &gt; <a href="" title="local variable n0_c">n0_c</a>)</span>
<a id="line1074"></a><span class="lineno">1074</span><span class="line">    <a href="../../../../Scopes/vsip/impl.html#conv_min_lT_S_clength_type_clength_type_cstride_type_cstride_type_cT_S_clength_type_clength_type_cstride_type_cstride_type_cT_S_clength_type_clength_type_cstride_type_cstride_type_clength_type_r" title="function template vsip::impl::conv_min(T*,length_type,length_type,stride_type,stride_type,T*,length_type,length_type,stride_type,stride_type,T*,length_type,length_type,stride_type,stride_type,length_type)">conv_min&lt;T&gt;</a>(<a href="" title="parameter coeff">coeff</a>,</span>
<a id="line1075"></a><span class="lineno">1075</span><span class="line">		<a href="" title="parameter coeff_rows">coeff_rows</a>, <a href="" title="parameter coeff_cols">coeff_cols</a>,</span>
<a id="line1076"></a><span class="lineno">1076</span><span class="line">		<a href="" title="parameter coeff_row_stride">coeff_row_stride</a>, <a href="" title="parameter coeff_col_stride">coeff_col_stride</a>,</span>
<a id="line1077"></a><span class="lineno">1077</span>
<a id="line1078"></a><span class="lineno">1078</span><span class="line">		<a href="" title="local variable in_adj">in_adj</a>,</span>
<a id="line1079"></a><span class="lineno">1079</span><span class="line">		<a href="" title="parameter in_rows">in_rows</a> - <a href="" title="local variable phase_r">phase_r</a>, <a href="" title="parameter in_cols">in_cols</a> - <a href="" title="local variable phase_c">phase_c</a>,</span>
<a id="line1080"></a><span class="lineno">1080</span><span class="line">		<a href="" title="parameter in_row_stride">in_row_stride</a>, <a href="" title="parameter in_col_stride">in_col_stride</a>,</span>
<a id="line1081"></a><span class="lineno">1081</span>
<a id="line1082"></a><span class="lineno">1082</span><span class="line">		<a href="" title="local variable out_adj">out_adj</a>,</span>
<a id="line1083"></a><span class="lineno">1083</span><span class="line">		<a href="" title="local variable n1_r">n1_r</a> - <a href="" title="local variable n0_r">n0_r</a>, <a href="" title="local variable n1_c">n1_c</a> - <a href="" title="local variable n0_c">n0_c</a>,</span>
<a id="line1084"></a><span class="lineno">1084</span><span class="line">		<a href="" title="parameter out_row_stride">out_row_stride</a>, <a href="" title="parameter out_col_stride">out_col_stride</a>,</span>
<a id="line1085"></a><span class="lineno">1085</span><span class="line">		<a href="" title="parameter decimation">decimation</a>);</span>
<a id="line1086"></a><span class="lineno">1086</span>
<a id="line1087"></a><span class="lineno">1087</span><span class="line">  <a href="../../../../Scopes/vsip/impl.html#conv_same_edge_lT_S_clength_type_clength_type_cstride_type_cstride_type_cT_S_clength_type_clength_type_cstride_type_cstride_type_cT_S_clength_type_clength_type_cstride_type_cstride_type_clength_type_r" title="function template vsip::impl::conv_same_edge(T*,length_type,length_type,stride_type,stride_type,T*,length_type,length_type,stride_type,stride_type,T*,length_type,length_type,stride_type,stride_type,length_type)">conv_same_edge&lt;T&gt;</a>(</span>
<a id="line1088"></a><span class="lineno">1088</span><span class="line">    <a href="" title="parameter coeff">coeff</a>, <a href="" title="parameter coeff_rows">coeff_rows</a>, <a href="" title="parameter coeff_cols">coeff_cols</a>, <a href="" title="parameter coeff_row_stride">coeff_row_stride</a>, <a href="" title="parameter coeff_col_stride">coeff_col_stride</a>,</span>
<a id="line1089"></a><span class="lineno">1089</span><span class="line">    <a href="" title="parameter in">in</a>, <a href="" title="parameter in_rows">in_rows</a>, <a href="" title="parameter in_cols">in_cols</a>, <a href="" title="parameter in_row_stride">in_row_stride</a>, <a href="" title="parameter in_col_stride">in_col_stride</a>,</span>
<a id="line1090"></a><span class="lineno">1090</span><span class="line">    <a href="" title="parameter out">out</a>, <a href="" title="parameter out_rows">out_rows</a>, <a href="" title="parameter out_cols">out_cols</a>, <a href="" title="parameter out_row_stride">out_row_stride</a>, <a href="" title="parameter out_col_stride">out_col_stride</a>,</span>
<a id="line1091"></a><span class="lineno">1091</span><span class="line">    <a href="" title="parameter decimation">decimation</a>);</span>
<a id="line1092"></a><span class="lineno">1092</span><span class="line">}</span>
<a id="line1093"></a><span class="lineno">1093</span>
<a id="line1094"></a><span class="lineno">1094</span>
<a id="line1095"></a><span class="lineno">1095</span>
<a id="line1096"></a><span class="lineno">1096</span><span class="line">} <span class="comment">// namespace vsip::impl</span></span>
<a id="line1097"></a><span class="lineno">1097</span>
<a id="line1098"></a><span class="lineno">1098</span><span class="line">} <span class="comment">// namespace vsip</span></span>
<a id="line1099"></a><span class="lineno">1099</span>
<a id="line1100"></a><span class="lineno">1100</span><span class="line">#endif // VSIP_CORE_SIGNAL_CONV_COMMON_HPP</span>
</pre>
<div class="logo">Generated on Wed Sep 30 14:29:54 2009 by 
<br/>
<a href="http://synopsis.fresco.org" target="_blank"><img src="../../../../synopsis.png" alt="logo"/> synopsis</a> (version 0.12)</div>
</body>
</html>
